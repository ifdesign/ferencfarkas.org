var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function i(e){e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function a(e){return document.createElement(e)}function d(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function f(e){return document.createTextNode(e)}function p(){return f(" ")}function h(){return f("")}function g(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function m(e){return function(t){return t.preventDefault(),e.call(this,t)}}function b(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function $(e,t){e.value=null==t?"":t}function k(e,t,n,l){e.style.setProperty(t,n,l?"important":"")}function v(e,t,n){e.classList[n?"add":"remove"](t)}let y;function x(e){y=e}function L(){if(!y)throw new Error("Function called outside component initialization");return y}function O(){const e=L();return(t,n)=>{const l=e.$$.callbacks[t];if(l){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach((t=>{t.call(e,r)}))}}}function j(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const C=[],F=[],_=[],I=[],S=Promise.resolve();let E=!1;function V(e){_.push(e)}let D=!1;const q=new Set;function M(){if(!D){D=!0;do{for(let e=0;e<C.length;e+=1){const t=C[e];x(t),A(t.$$)}for(x(null),C.length=0;F.length;)F.pop()();for(let e=0;e<_.length;e+=1){const t=_[e];q.has(t)||(q.add(t),t())}_.length=0}while(C.length);for(;I.length;)I.pop()();E=!1,D=!1,q.clear()}}function A(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(V)}}const H=new Set;let N;function B(){N={r:0,c:[],p:N}}function R(){N.r||l(N.c),N=N.p}function T(e,t){e&&e.i&&(H.delete(e),e.i(t))}function J(e,t,n,l){if(e&&e.o){if(H.has(e))return;H.add(e),N.c.push((()=>{H.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}}function P(e,t){J(e,1,1,(()=>{t.delete(e.key)}))}function U(e){e&&e.c()}function z(e,n,o){const{fragment:c,on_mount:s,on_destroy:i,after_update:u}=e.$$;c&&c.m(n,o),V((()=>{const n=s.map(t).filter(r);i?i.push(...n):l(n),e.$$.on_mount=[]})),u.forEach(V)}function Q(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function G(e,t){-1===e.$$.dirty[0]&&(C.push(e),E||(E=!0,S.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function W(t,r,o,c,s,u,a=[-1]){const d=y;x(t);const f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let p=!1;if(f.ctx=o?o(t,r.props||{},((e,n,...l)=>{const r=l.length?l[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=r)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](r),p&&G(t,e)),n})):[],f.update(),p=!0,l(f.before_update),f.fragment=!!c&&c(f.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);f.fragment&&f.fragment.l(e),e.forEach(i)}else f.fragment&&f.fragment.c();r.intro&&T(t.$$.fragment),z(t,r.target,r.anchor),M()}x(d)}class Y{$destroy(){Q(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Z={catalogue:"/_catalogue/c.json",index:"/_catalogue/i.json",i18n:"/_catalogue/i18n/en.json"};const K={lt2:{label:"< 2‘ ",compute:e=>e<120},f2t5:{label:"2‘ – 5‘",compute:e=>e>=120&&e<300},f5t15:{label:"5‘ – 15‘",compute:e=>e>=300&&e<900},f15t30:{label:"15‘ – 30‘",compute:e=>e>=900&&e<1800},f30t1h:{label:"30‘ – 1h",compute:e=>e>=1800&&e<3600},f1ht2h:{label:"1h – 2h",compute:e=>e>=3600&&e<=7200},gt2h:{label:"> 2h",compute:e=>e>7200}};var X={g:{order:1,collapsed:!1,label:"Genres",getValues:e=>[e.genre],getLabel:({value:e,genres:t={}})=>t[e]?.title},c:{order:2,collapsed:!1,label:"Categories",getValues:e=>[e.category],getLabel:({value:e,categories:t={}})=>t[e]?.title},l:{order:3,collapsed:!0,label:"Languages",getValues:e=>Object.keys({...e.texts,...e.libretto}),getLabel:({value:e})=>e.toUpperCase()},p:{order:4,collapsed:!0,label:"Publishers",getValues:e=>e.publications?e.publications.reduce(((e,t)=>{const n=t.publisher_id;return e.includes(n)||e.push(n),e}),[]):["unpublished"],getLabel:({value:e,publishers:t={}})=>"unpublished"===e?"Unpublished":t[e]?.shortName||t[e]?.name},m:{order:5,collapsed:!0,label:"Multimedia",getValues:e=>[],getLabel:({value:e})=>e},t:{order:6,collapsed:!0,label:"Durations",getValues:e=>Object.entries(K).filter((([t,{compute:n}])=>n(e.duration))).map((([e])=>e)),getLabel:({value:e})=>K[e].label},d:{order:7,collapsed:!1,label:"Composition decennies",getValues:e=>{const t=/(19|20)\d{2}/gim;let n;const l=[];for(;null!==(n=t.exec(e.composition_date));)n.index===t.lastIndex&&t.lastIndex++,l.push(n[0]);return l.reduce(((e,t)=>{t.endsWith(0)&&(t-=1);const n=Math.floor(parseInt(t)%1900/10),l=(n>10?`20${n}1 - 20${n+1}0`:9===n?`19${n}1 - 2001`:`19${n}1 - 19${n+1}0`).substr(0,3)+"0s";return e.includes(l)||e.push(l),e}),[])},getLabel:({value:e})=>{const t=parseInt(e.substr(0,4));return[t+1,t+10].join(" - ")}}};function ee(e="_",t){const n=t=>`${e}.${t}`;return Array.isArray(t)?[].concat(t).map((e=>n(e))):n(t)}const te={activeFacets:[],page:1,query:"",reworksOf:"",showID:!1,sort:{field:"title",dir:"asc"}};function ne(e){const t=function(e){const t=Object.entries(e).filter((([e,t])=>t)).reduce(((e,[t,n])=>(Array.isArray(n)&&n.length?e.push(`${t}=${n.join(",")}`):"string"==typeof n&&""!==n?e.push(`${t}=${n}`):!0===n&&e.push(`${t}`),e)),[]).join("&");return t&&`?${t}`}({q:e.query,f:e.activeFacets,r:e.reworksOf,showID:e.showID});window.history.replaceState(e,"",`${window.location.pathname}${t}`)}function le(){const e=window.location.search.split(/[\?&]/).filter((e=>e)).reduce(((e,t)=>{const[n,l]=t.split("=");let r=l?.split(",")||!0;return!0===r?e[n]=!0:1===r.length?e[n]=decodeURIComponent(l):e[n]=r.map((e=>decodeURIComponent(e))),e}),{});return{activeFacets:e.f&&[].concat(e.f)||te.activeFacets,page:e.p||te.page,query:e.q||te.query,reworksOf:e.r||te.reworksOf,showID:e.showID||te.showID,sort:e.s?.split(".").reduce(((e,t,n)=>(0===n?e.field=t:e.dir=t,e)),{})||te.sort}}let re,oe,ce;function se(e){setTimeout((()=>{re=e.querySelector(".refine--wrapper"),oe=e.querySelector(".refine--inner"),ce=e.querySelector(".works--list")}),200),window.addEventListener("scroll",ie),window.addEventListener("resize",ie)}function ie(){if(!re||!ce||!oe)return;const e=oe.getBoundingClientRect(),t=ce.getBoundingClientRect();t.top>0?(re.classList.remove("sticked"),re.classList.remove("scrolled")):t.bottom>=e.height?(re.classList.add("sticked"),re.classList.remove("scrolled")):(re.classList.add("scrolled"),re.classList.remove("sticked"))}function ue(e,t,n){const l=e.slice();return l[6]=t[n].key,l[7]=t[n].value,l}function ae(e,t,n){const l=e.slice();return l[23]=t[n],l}function de(e,t,n){const l=e.slice();return l[20]=t[n],l}function fe(e,t,n){const l=e.slice();return l[17]=t[n],l[19]=n,l}function pe(e,t,n){const l=e.slice();return l[14]=t[n],l}function he(e,t,n){const l=e.slice();return l[10]=t[n].role,l[11]=t[n].voice,l}function ge(t){let n,l=t[7]+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function me(e){let t;let n=function(e,t){return e[7].credits?xe:ye}(e)(e);return{c(){n.c(),t=h()},m(e,l){n.m(e,l),s(e,t,l)},p(e,t){n.p(e,t)},d(e){n.d(e),e&&i(t)}}}function be(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Oe(de(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(6&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=de(e,n,o);l[o]?l[o].p(c,r):(l[o]=Oe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function we(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=je(fe(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c();b(t,"class","movements")},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=fe(e,n,o);l[o]?l[o].p(c,r):(l[o]=je(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function $e(e){let t,n=Object.values(e[7]),l=[];for(let t=0;t<n.length;t+=1)l[t]=Ce(pe(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=Object.values(e[7]),o=0;o<n.length;o+=1){const c=pe(e,n,o);l[o]?l[o].p(c,r):(l[o]=Ce(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ke(t){let n,l=Se(t[7])+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function ve(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Fe(he(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=he(e,n,o);l[o]?l[o].p(c,r):(l[o]=Fe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ye(t){let n,l=Ee(t[7])+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function xe(e){let t,n,l,r,o=Ee(e[7])+"",d=e[7].credits,h=[];for(let t=0;t<d.length;t+=1)h[t]=Le(ae(e,d,t));return{c(){t=a("ul"),n=a("li"),l=f(o),r=p();for(let e=0;e<h.length;e+=1)h[e].c()},m(e,o){s(e,t,o),c(t,n),c(n,l),c(t,r);for(let e=0;e<h.length;e+=1)h[e].m(t,null)},p(e,n){if(4&n){let l;for(d=e[7].credits,l=0;l<d.length;l+=1){const r=ae(e,d,l);h[l]?h[l].p(r,n):(h[l]=Le(r),h[l].c(),h[l].m(t,null))}for(;l<h.length;l+=1)h[l].d(1);h.length=d.length}},d(e){e&&i(t),u(h,e)}}}function Le(t){let n,l,r=t[23]+"";return{c(){n=a("li"),l=f(r)},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}function Oe(t){let n,l,r,o,u,d=t[1][t[20].publisher_id].name+"",h="all"!==t[20].type&&function(t){let n,l,r,o=t[20].type+"";return{c(){n=a("span"),l=f(o),r=f(":")},m(e,t){s(e,n,t),c(n,l),c(n,r)},p:e,d(e){e&&i(n)}}}(t);return{c(){n=a("li"),h&&h.c(),l=p(),r=a("a"),o=f(d),u=p(),b(r,"href","#"),b(r,"class","link")},m(e,t){s(e,n,t),h&&h.m(n,null),c(n,l),c(n,r),c(r,o),c(n,u)},p(e,t){"all"!==e[20].type&&h.p(e,t),2&t&&d!==(d=e[1][e[20].publisher_id].name+"")&&w(o,d)},d(e){e&&i(n),h&&h.d()}}}function je(t){let n,l,r,o,u,d,h,g,m,w=t[19]+1+"",$=t[17].title+"",k=t[17].duration&&function(t){let n,l,r=Se(t[17].duration)+"";return{c(){n=a("span"),l=f(r),b(n,"class","movement--duration")},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}(t);return{c(){n=a("li"),l=a("span"),r=f(w),o=f(")"),u=p(),d=a("span"),h=f($),g=p(),k&&k.c(),m=p(),b(l,"class","movement--pos"),b(d,"class","movement--title"),b(n,"class","movement")},m(e,t){s(e,n,t),c(n,l),c(l,r),c(l,o),c(n,u),c(n,d),c(d,h),c(n,g),k&&k.m(n,null),c(n,m)},p(e,t){e[17].duration&&k.p(e,t)},d(e){e&&i(n),k&&k.d()}}}function Ce(t){let n,l,r=t[14]+"";return{c(){n=a("li"),l=f(r)},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}function Fe(t){let n,l,r,o,u,d,h=t[10]+"",g=t[11]+"";return{c(){n=a("li"),l=f(h),r=f(" - "),o=a("span"),u=f(g),d=p()},m(e,t){s(e,n,t),c(n,l),c(n,r),c(n,o),c(o,u),c(n,d)},p:e,d(e){e&&i(n)}}}function _e(e){let t,n,l,r,o,u,d=e[0].fields[e[6]]+"";let h=function(e,t){return"cast"===e[6]?ve:"duration"===e[6]?ke:"libretto"===e[6]||"texts"===e[6]?$e:"movements"===e[6]?we:"publications"===e[6]?be:"world_premiere"===e[6]?me:ge}(e)(e);return{c(){t=a("div"),n=a("dt"),l=f(d),r=p(),o=a("dd"),h.c(),u=p(),b(n,"class",e[6]),b(t,"class","work--field")},m(e,i){s(e,t,i),c(t,n),c(n,l),c(t,r),c(t,o),h.m(o,null),c(t,u)},p(e,t){1&t&&d!==(d=e[0].fields[e[6]]+"")&&w(l,d),h.p(e,t)},d(e){e&&i(t),h.d()}}}function Ie(t){let n,l=t[2],r=[];for(let e=0;e<l.length;e+=1)r[e]=_e(ue(t,l,e));return{c(){n=a("dl");for(let e=0;e<r.length;e+=1)r[e].c();b(n,"class","work--fields")},m(e,t){s(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,[t]){if(7&t){let o;for(l=e[2],o=0;o<l.length;o+=1){const c=ue(e,l,o);r[o]?r[o].p(c,t):(r[o]=_e(c),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=l.length}},i:e,o:e,d(e){e&&i(n),u(r,e)}}}function Se(e){const t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),l=Math.floor(e-3600*t-60*n);let r="";return t>0&&(r+=`${t}h `),n>0&&(r+=`${n}‘ `),l>0&&(r+=`${l}”`),r}function Ee({date:e,location:t}){let n=[];return e&&(e.toString().includes("T")&&(e=function(e){return new Date(e).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric"})}(e)),n.push(e)),t&&n.push(t),n.join(" - ")}function Ve(e,t,n){let{fields:l=[]}=t,{i18n:r={}}=t,{publishers:o={}}=t,{work:c={}}=t;const s=["audios","category","date","default","description","facets","filtered","genre","id","isDefaultVersion","rework","rework_of","story","title","versions","works"],i=Object.entries(c).filter((([e])=>!s.includes(e))).sort(((e,t)=>{const n=l.indexOf(e[0]),r=l.indexOf(t[0]);return n>r?1:n<r?-1:0})).map((([e,t])=>({key:e,value:t})));return e.$$set=e=>{"fields"in e&&n(3,l=e.fields),"i18n"in e&&n(0,r=e.i18n),"publishers"in e&&n(1,o=e.publishers),"work"in e&&n(4,c=e.work)},[r,o,i,l,c]}class De extends Y{constructor(e){super(),W(this,e,Ve,Ie,o,{fields:3,i18n:0,publishers:1,work:4})}}function qe(e,t,n){const l=e.slice();return l[23]=t[n],l}function Me(e,t,n){const l=e.slice();return l[26]=t[n],l}function Ae(e,t,n){const l=e.slice();return l[29]=t[n],l}function He(e){let t,n,l,r,o,u,d,p,h,$,k,v;return{c(){t=a("div"),n=a("p"),l=f("You are seeing the list of works that have been reworked based on\n        "),r=a("strong"),o=f(e[12]),u=f(".\n        "),d=a("br"),p=f("\n        You can go "),h=a("button"),h.textContent="back to the previous list",$=f(' by\n        clicking ony any of the "Rework" / "Reworked" buttons.'),b(h,"class","link back"),b(t,"class","work--rework-info")},m(i,a){s(i,t,a),c(t,n),c(n,l),c(n,r),c(r,o),c(n,u),c(n,d),c(n,p),c(n,h),c(n,$),k||(v=g(h,"click",m(e[16])),k=!0)},p(e,t){4096&t[0]&&w(o,e[12])},d(e){e&&i(t),k=!1,v()}}}function Ne(e){let t,n,l,r,o=e[8].id+"";return{c(){t=a("button"),n=f(o),b(t,"class","work--id")},m(o,i){s(o,t,i),c(t,n),l||(r=g(t,"click",e[18]),l=!0)},p(e,t){256&t[0]&&o!==(o=e[8].id+"")&&w(n,o)},d(e){e&&i(t),l=!1,r()}}}function Be(e){let t,n,l,r,o=e[0][e[8].category].tag+"";return{c(){t=a("button"),n=f(o),b(t,"class","tag"),t.disabled=e[6]},m(o,i){s(o,t,i),c(t,n),l||(r=g(t,"click",m(e[19])),l=!0)},p(e,l){257&l[0]&&o!==(o=e[0][e[8].category].tag+"")&&w(n,o),64&l[0]&&(t.disabled=e[6])},d(e){e&&i(t),l=!1,r()}}}function Re(e){let t,n,l,r;function o(e,t){return e[11]?Je:Te}let c=o(e),u=c(e);return{c(){t=a("button"),u.c(),b(t,"class",n="tag border rework"+(e[9]?"":"ed")),v(t,"active",e[6])},m(n,o){s(n,t,o),u.m(t,null),l||(r=g(t,"click",m(e[16])),l=!0)},p(e,l){c===(c=o(e))&&u?u.p(e,l):(u.d(1),u=c(e),u&&(u.c(),u.m(t,null))),512&l[0]&&n!==(n="tag border rework"+(e[9]?"":"ed"))&&b(t,"class",n),576&l[0]&&v(t,"active",e[6])},d(e){e&&i(t),u.d(),l=!1,r()}}}function Te(e){let t,n,l=e[9]?"":"ed";return{c(){t=f("Rework"),n=f(l)},m(e,l){s(e,t,l),s(e,n,l)},p(e,t){512&t[0]&&l!==(l=e[9]?"":"ed")&&w(n,l)},d(e){e&&i(t),e&&i(n)}}}function Je(t){let n;return{c(){n=f("Reworked")},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function Pe(e){let t,n,l,r,o,u,d,h=(e[8].texts||e[8].libretto)&&Ue(e),m=e[8].title.sort.length>1&&Qe(e);return{c(){t=a("h3"),n=a("span"),l=f(e[12]),r=p(),h&&h.c(),o=p(),m&&m.c(),b(t,"class","work--title")},m(i,a){s(i,t,a),c(t,n),c(n,l),c(t,r),h&&h.m(t,null),c(t,o),m&&m.m(t,null),u||(d=g(t,"click",e[15]),u=!0)},p(e,n){4096&n[0]&&w(l,e[12]),e[8].texts||e[8].libretto?h?h.p(e,n):(h=Ue(e),h.c(),h.m(t,o)):h&&(h.d(1),h=null),e[8].title.sort.length>1?m?m.p(e,n):(m=Qe(e),m.c(),m.m(t,null)):m&&(m.d(1),m=null)},d(e){e&&i(t),h&&h.d(),m&&m.d(),u=!1,d()}}}function Ue(e){let t,n=Object.keys({...e[8].texts,...e[8].libretto}),l=[];for(let t=0;t<n.length;t+=1)l[t]=ze(Ae(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c();b(t,"class","work--languages")},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(256&r[0]){let o;for(n=Object.keys({...e[8].texts,...e[8].libretto}),o=0;o<n.length;o+=1){const c=Ae(e,n,o);l[o]?l[o].p(c,r):(l[o]=ze(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ze(e){let t,n,l=e[29]+"";return{c(){t=a("li"),n=f(l)},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[29]+"")&&w(n,l)},d(e){e&&i(t)}}}function Qe(e){let t,n,l=e[8].title.sort.filter(e[20]).map(e[21]).join(" / ")+"";return{c(){t=a("div"),n=f(l),b(t,"class","work--title-translations")},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[8].title.sort.filter(e[20]).map(e[21]).join(" / ")+"")&&w(n,l)},d(e){e&&i(t)}}}function Ge(e){let t,n,l,r,o,u=e[8].description+"",d=e[8].note&&We(e);return{c(){t=a("div"),n=f(u),l=p(),d&&d.c(),b(t,"class","work--description")},m(i,u){s(i,t,u),c(t,n),c(t,l),d&&d.m(t,null),r||(o=g(t,"click",e[15]),r=!0)},p(e,l){256&l[0]&&u!==(u=e[8].description+"")&&w(n,u),e[8].note?d?d.p(e,l):(d=We(e),d.c(),d.m(t,null)):d&&(d.d(1),d=null)},d(e){e&&i(t),d&&d.d(),r=!1,o()}}}function We(e){let t,n,l=e[8].note+"";return{c(){t=a("div"),n=f(l),b(t,"class","work--note")},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[8].note+"")&&w(n,l)},d(e){e&&i(t)}}}function Ye(e){let t,n,l,r,o=e[8].version+"";return{c(){t=a("div"),n=f(o),b(t,"class","work--version")},m(o,i){s(o,t,i),c(t,n),l||(r=g(t,"click",e[15]),l=!0)},p(e,t){256&t[0]&&o!==(o=e[8].version+"")&&w(n,o)},d(e){e&&i(t),l=!1,r()}}}function Ze(e){let t,n;return t=new De({props:{work:e[8],fields:e[1],i18n:e[2],publishers:e[5]}}),{c(){U(t.$$.fragment)},m(e,l){z(t,e,l),n=!0},p(e,n){const l={};256&n[0]&&(l.work=e[8]),2&n[0]&&(l.fields=e[1]),4&n[0]&&(l.i18n=e[2]),32&n[0]&&(l.publishers=e[5]),t.$set(l)},i(e){n||(T(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){Q(t,e)}}}function Ke(e){let t,n,l=e[8].versions,r=[];for(let t=0;t<l.length;t+=1)r[t]=Xe(Me(e,l,t));const o=e=>J(r[e],1,1,(()=>{r[e]=null}));return{c(){t=a("ul");for(let e=0;e<r.length;e+=1)r[e].c();b(t,"class","works--list")},m(e,l){s(e,t,l);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,n){if(295&n[0]){let c;for(l=e[8].versions,c=0;c<l.length;c+=1){const o=Me(e,l,c);r[c]?(r[c].p(o,n),T(r[c],1)):(r[c]=Xe(o),r[c].c(),T(r[c],1),r[c].m(t,null))}for(B(),c=l.length;c<r.length;c+=1)o(c);R()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)T(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)J(r[e]);n=!1},d(e){e&&i(t),u(r,e)}}}function Xe(e){let t,n;return t=new st({props:{work:e[26],isSub:!0,categories:e[0],fields:e[1],i18n:e[2],publishers:e[5]}}),{c(){U(t.$$.fragment)},m(e,l){z(t,e,l),n=!0},p(e,n){const l={};256&n[0]&&(l.work=e[26]),1&n[0]&&(l.categories=e[0]),2&n[0]&&(l.fields=e[1]),4&n[0]&&(l.i18n=e[2]),32&n[0]&&(l.publishers=e[5]),t.$set(l)},i(e){n||(T(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){Q(t,e)}}}function et(e){let t,n,l=e[8].story&&tt(e),r=e[8].audios&&nt(e);return{c(){t=a("div"),l&&l.c(),n=p(),r&&r.c(),b(t,"class","work--multimedia")},m(e,o){s(e,t,o),l&&l.m(t,null),c(t,n),r&&r.m(t,null)},p(e,o){e[8].story?l?l.p(e,o):(l=tt(e),l.c(),l.m(t,n)):l&&(l.d(1),l=null),e[8].audios?r?r.p(e,o):(r=nt(e),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(e){e&&i(t),l&&l.d(),r&&r.d()}}}function tt(e){let t,n,l;return{c(){t=a("a"),n=f("About the work"),b(t,"class","link work--story"),b(t,"href",l=e[8].story)},m(e,l){s(e,t,l),c(t,n)},p(e,n){256&n[0]&&l!==(l=e[8].story)&&b(t,"href",l)},d(e){e&&i(t)}}}function nt(e){let t,n=e[8].audios,l=[];for(let t=0;t<n.length;t+=1)l[t]=lt(qe(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=h()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);s(e,t,n)},p(e,r){if(256&r[0]){let o;for(n=e[8].audios,o=0;o<n.length;o+=1){const c=qe(e,n,o);l[o]?l[o].p(c,r):(l[o]=lt(c),l[o].c(),l[o].m(t.parentNode,t))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){u(l,e),e&&i(t)}}}function lt(e){let t,n,l,r,o,u,d,h,$,k,v,y=e[23].description+"";function x(...t){return e[22](e[23],...t)}return{c(){t=a("button"),n=a("div"),l=p(),r=a("div"),o=a("h5"),u=f(y),d=p(),b(n,"class","play--button"),b(r,"class","play--meta"),b(t,"class","play small"),b(t,"data-audio",h=e[23].id),b(t,"data-title",$=e[23].description)},m(e,i){s(e,t,i),c(t,n),c(t,l),c(t,r),c(r,o),c(o,u),c(t,d),k||(v=g(t,"click",m(x)),k=!0)},p(n,l){e=n,256&l[0]&&y!==(y=e[23].description+"")&&w(u,y),256&l[0]&&h!==(h=e[23].id)&&b(t,"data-audio",h),256&l[0]&&$!==($=e[23].description)&&b(t,"data-title",$)},d(e){e&&i(t),k=!1,v()}}}function rt(e){let t;return{c(){t=a("div"),t.textContent="Reworks",b(t,"class","work--rework-label")},m(e,n){s(e,t,n)},d(e){e&&i(t)}}}function ot(e){let t,n,l,r,o,u,d,f,h,g,m,w,$,k,y,x,L=e[11]&&He(e),O=e[7]&&e[8].id&&Ne(e),j=e[8].category&&Be(e),C=e[8].rework&&Re(e),F=e[8].title&&Pe(e),_=e[8].description&&Ge(e),I=e[8].version&&!e[8].isDefaultVersion&&Ye(e),S=e[1].length&&Ze(e),E=e[8].versions&&Ke(e),V=(e[8].story||e[8].audios)&&et(e),D=e[11]&&rt();return{c(){t=a("li"),L&&L.c(),n=p(),l=a("div"),O&&O.c(),r=p(),j&&j.c(),o=p(),C&&C.c(),u=p(),F&&F.c(),d=p(),_&&_.c(),f=p(),I&&I.c(),h=p(),S&&S.c(),g=p(),E&&E.c(),m=p(),V&&V.c(),$=p(),D&&D.c(),b(l,"class",w="work--"+(e[4]?"sub":"container")),v(l,"open",e[10]),v(l,"black",e[11]),v(l,"selected",e[13]),b(t,"class","work"),b(t,"id",k=e[8].id),b(t,"data-index",y=e[11]?"":e[6]?e[3]:e[3]+1)},m(e,i){s(e,t,i),L&&L.m(t,null),c(t,n),c(t,l),O&&O.m(l,null),c(l,r),j&&j.m(l,null),c(l,o),C&&C.m(l,null),c(l,u),F&&F.m(l,null),c(l,d),_&&_.m(l,null),c(l,f),I&&I.m(l,null),c(l,h),S&&S.m(l,null),c(l,g),E&&E.m(l,null),c(l,m),V&&V.m(l,null),c(t,$),D&&D.m(t,null),x=!0},p(e,c){e[11]?L?L.p(e,c):(L=He(e),L.c(),L.m(t,n)):L&&(L.d(1),L=null),e[7]&&e[8].id?O?O.p(e,c):(O=Ne(e),O.c(),O.m(l,r)):O&&(O.d(1),O=null),e[8].category?j?j.p(e,c):(j=Be(e),j.c(),j.m(l,o)):j&&(j.d(1),j=null),e[8].rework?C?C.p(e,c):(C=Re(e),C.c(),C.m(l,u)):C&&(C.d(1),C=null),e[8].title?F?F.p(e,c):(F=Pe(e),F.c(),F.m(l,d)):F&&(F.d(1),F=null),e[8].description?_?_.p(e,c):(_=Ge(e),_.c(),_.m(l,f)):_&&(_.d(1),_=null),e[8].version&&!e[8].isDefaultVersion?I?I.p(e,c):(I=Ye(e),I.c(),I.m(l,h)):I&&(I.d(1),I=null),e[1].length?S?(S.p(e,c),2&c[0]&&T(S,1)):(S=Ze(e),S.c(),T(S,1),S.m(l,g)):S&&(B(),J(S,1,1,(()=>{S=null})),R()),e[8].versions?E?(E.p(e,c),256&c[0]&&T(E,1)):(E=Ke(e),E.c(),T(E,1),E.m(l,m)):E&&(B(),J(E,1,1,(()=>{E=null})),R()),e[8].story||e[8].audios?V?V.p(e,c):(V=et(e),V.c(),V.m(l,null)):V&&(V.d(1),V=null),(!x||16&c[0]&&w!==(w="work--"+(e[4]?"sub":"container")))&&b(l,"class",w),1040&c[0]&&v(l,"open",e[10]),2064&c[0]&&v(l,"black",e[11]),8208&c[0]&&v(l,"selected",e[13]),e[11]?D||(D=rt(),D.c(),D.m(t,null)):D&&(D.d(1),D=null),(!x||256&c[0]&&k!==(k=e[8].id))&&b(t,"id",k),(!x||2120&c[0]&&y!==(y=e[11]?"":e[6]?e[3]:e[3]+1))&&b(t,"data-index",y)},i(e){x||(T(S),T(E),x=!0)},o(e){J(S),J(E),x=!1},d(e){e&&i(t),L&&L.d(),O&&O.d(),j&&j.d(),C&&C.d(),F&&F.d(),_&&_.d(),I&&I.d(),S&&S.d(),E&&E.d(),V&&V.d(),D&&D.d()}}}function ct(e,t,n){let l,r,o,c,{categories:s={}}=t,{fields:i=[]}=t,{i18n:u={}}=t,{index:a=-1}=t,{isSub:d=!1}=t,{publishers:f={}}=t,{reworkActive:p=!1}=t,{showID:h=!1}=t,{work:g={}}=t;const m=O();let b=!1,w=!1;return e.$$set=e=>{"categories"in e&&n(0,s=e.categories),"fields"in e&&n(1,i=e.fields),"i18n"in e&&n(2,u=e.i18n),"index"in e&&n(3,a=e.index),"isSub"in e&&n(4,d=e.isSub),"publishers"in e&&n(5,f=e.publishers),"reworkActive"in e&&n(6,p=e.reworkActive),"showID"in e&&n(7,h=e.showID),"work"in e&&n(8,g=e.work)},e.$$.update=()=>{256&e.$$.dirty[0]&&n(9,l=g.rework!==g.id),576&e.$$.dirty[0]&&n(11,r=p&&!l),256&e.$$.dirty[0]&&n(12,o=g.title?.translations[g.title?.main]),131136&e.$$.dirty[0]&&n(13,c=w&&p)},[s,i,u,a,d,f,p,h,g,l,b,r,o,c,m,function(){n(10,b=!b)},function(){n(17,w=!p),m("showReworks",g.rework||g.id)},w,e=>navigator.clipboard.writeText(e.target.textContent),()=>m("selectCategory",g.category),e=>e!==g.title.main,e=>g.title.translations[e],(e,t)=>{window.dispatchEvent(new window.CustomEvent("play",{detail:{target:t.target,audio:e.id}}))}]}class st extends Y{constructor(e){super(),W(this,e,ct,ot,o,{categories:0,fields:1,i18n:2,index:3,isSub:4,publishers:5,reworkActive:6,showID:7,work:8},[-1,-1])}}function it(t){let n,l,r;return{c(){n=f("Filter works\n"),l=a("span"),r=f(t[0]),b(l,"class","tag works--count")},m(e,t){s(e,n,t),s(e,l,t),c(l,r)},p(e,[t]){1&t&&w(r,e[0])},i:e,o:e,d(e){e&&i(n),e&&i(l)}}}function ut(e,t,n){let{count:l=0}=t;return e.$$set=e=>{"count"in e&&n(0,l=e.count)},[l]}class at extends Y{constructor(e){super(),W(this,e,ut,it,o,{count:0})}}function dt(e){let t;return{c(){t=a("div"),t.innerHTML='<label class="inline"><input type="checkbox" name="title"/>\n        Title</label> \n      <label class="inline"><input type="checkbox" name="description"/>\n        Description</label> \n      <label class="inline"><input type="checkbox" name="version"/>\n        Version</label> \n      <label class="inline"><input type="checkbox" name="composition-date"/>\n        Composition date</label> \n      <label class="inline"><input type="checkbox" name="composition-location"/>\n        Composition location</label>',b(t,"class","search--fields-wrapper")},m(e,n){s(e,t,n)},d(e){e&&i(t)}}}function ft(t){let n,r,o,u,d,f,h,m,w=t[1]&&dt();return{c(){n=a("div"),r=a("div"),o=a("input"),u=p(),d=a("button"),d.textContent="Search",f=p(),w&&w.c(),b(o,"type","search"),b(o,"name","q"),b(o,"placeholder","Filter with keywords"),b(d,"type","submit"),b(r,"class","search--query-wrapper"),v(r,"focused",t[2]),b(n,"class","search--query")},m(e,l){s(e,n,l),c(n,r),c(r,o),$(o,t[0]),c(r,u),c(r,d),c(n,f),w&&w.m(n,null),h||(m=[g(o,"input",t[3]),g(o,"focus",t[4]),g(o,"blur",t[5])],h=!0)},p(e,[t]){1&t&&$(o,e[0]),4&t&&v(r,"focused",e[2]),e[1]?w||(w=dt(),w.c(),w.m(n,null)):w&&(w.d(1),w=null)},i:e,o:e,d(e){e&&i(n),w&&w.d(),h=!1,l(m)}}}function pt(e,t,n){let{showFields:l=!1}=t,{value:r=""}=t;const o=O();let c=!1;return e.$$set=e=>{"showFields"in e&&n(1,l=e.showFields),"value"in e&&n(0,r=e.value)},e.$$.update=()=>{1&e.$$.dirty&&o("updateQuery",r)},[r,l,c,function(){r=this.value,n(0,r)},()=>n(2,c=!0),()=>n(2,c=!1)]}class ht extends Y{constructor(e){super(),W(this,e,pt,ft,o,{showFields:1,value:0})}}function gt(e,t,n){const l=e.slice();return l[9]=t[n].value,l[10]=t[n].facet,l[11]=t,l[12]=n,l}function mt(e){let t,n,r,o,u,d,h,m,$,k,v,y,x,L=e[10].label+"",O=e[10].count+"";function j(){e[6].call(r,e[11],e[12])}function C(){return e[7](e[9])}return{c(){t=a("li"),n=a("label"),r=a("input"),u=p(),d=a("span"),h=f(L),m=p(),$=a("span"),k=f(O),v=p(),b(r,"type","checkbox"),b(r,"name",o=ee(e[0],e[9])),b(d,"class","facet--name"),b($,"class","facet--count")},m(l,o){s(l,t,o),c(t,n),c(n,r),r.checked=e[10].active,c(n,u),c(n,d),c(d,h),c(n,m),c(n,$),c($,k),c(t,v),y||(x=[g(r,"change",j),g(r,"click",C)],y=!0)},p(t,n){e=t,17&n&&o!==(o=ee(e[0],e[9]))&&b(r,"name",o),16&n&&(r.checked=e[10].active),16&n&&L!==(L=e[10].label+"")&&w(h,L),16&n&&O!==(O=e[10].count+"")&&w(k,O)},d(e){e&&i(t),y=!1,l(x)}}}function bt(e){let t,n,l;function r(e,t){return e[3]?$t:wt}let o=r(e),c=o(e);return{c(){t=a("button"),c.c(),b(t,"class","link facet--more")},m(r,o){s(r,t,o),c.m(t,null),n||(l=g(t,"click",m(e[8])),n=!0)},p(e,n){o===(o=r(e))&&c?c.p(e,n):(c.d(1),c=o(e),c&&(c.c(),c.m(t,null)))},d(e){e&&i(t),c.d(),n=!1,l()}}}function wt(e){let t,n,l,r,o,c=e[1].toLowerCase()+"",u=Object.keys(e[2]).length-vt+"";return{c(){t=f("Show more "),n=f(c),l=f(" ("),r=f(u),o=f(")")},m(e,c){s(e,t,c),s(e,n,c),s(e,l,c),s(e,r,c),s(e,o,c)},p(e,t){2&t&&c!==(c=e[1].toLowerCase()+"")&&w(n,c),4&t&&u!==(u=Object.keys(e[2]).length-vt+"")&&w(r,u)},d(e){e&&i(t),e&&i(n),e&&i(l),e&&i(r),e&&i(o)}}}function $t(e){let t,n,l,r,o=e[1].toLowerCase()+"";return{c(){t=f("Show first "),n=f(vt),l=p(),r=f(o)},m(e,o){s(e,t,o),s(e,n,o),s(e,l,o),s(e,r,o)},p(e,t){2&t&&o!==(o=e[1].toLowerCase()+"")&&w(r,o)},d(e){e&&i(t),e&&i(n),e&&i(l),e&&i(r)}}}function kt(t){let n,l,r,o=Object.keys(t[2]).length>vt,c=t[4],d=[];for(let e=0;e<c.length;e+=1)d[e]=mt(gt(t,c,e));let f=o&&bt(t);return{c(){n=a("ul");for(let e=0;e<d.length;e+=1)d[e].c();l=p(),f&&f.c(),r=h()},m(e,t){s(e,n,t);for(let e=0;e<d.length;e+=1)d[e].m(n,null);s(e,l,t),f&&f.m(e,t),s(e,r,t)},p(e,[t]){if(49&t){let l;for(c=e[4],l=0;l<c.length;l+=1){const r=gt(e,c,l);d[l]?d[l].p(r,t):(d[l]=mt(r),d[l].c(),d[l].m(n,null))}for(;l<d.length;l+=1)d[l].d(1);d.length=c.length}4&t&&(o=Object.keys(e[2]).length>vt),o?f?f.p(e,t):(f=bt(e),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:e,o:e,d(e){e&&i(n),u(d,e),e&&i(l),f&&f.d(e),e&&i(r)}}}const vt=5;function yt(e,t,n){let l,{group:r=""}=t,{label:o=""}=t,{facets:c={}}=t;const s=O();let i=!1;return e.$$set=e=>{"group"in e&&n(0,r=e.group),"label"in e&&n(1,o=e.label),"facets"in e&&n(2,c=e.facets)},e.$$.update=()=>{12&e.$$.dirty&&n(4,l=function(e){return Object.entries(e).sort(((e,t)=>t[1].count>e[1].count?1:-1)).map((([e,t])=>({value:e,facet:t})))}(c).slice(0,i?c.length:vt))},[r,o,c,i,l,s,function(e,t){e[t].facet.active=this.checked,n(4,l),n(2,c),n(3,i)},e=>s("refine",ee(r,e)),()=>{n(3,i=!i)}]}class xt extends Y{constructor(e){super(),W(this,e,yt,kt,o,{group:0,label:1,facets:2})}}function Lt(e,t,n){const l=e.slice();return l[17]=t[n].group,l[18]=t[n].def,l}function Ot(e){let t,n,l,o,u,d,h,m,$,k,y,x,L=e[18].label+"";return h=new xt({props:{group:e[17],label:e[18].label,facets:e[18].facets}}),h.$on("refine",e[14]),{c(){t=a("div"),n=a("h4"),l=a("button"),o=p(),u=f(L),d=p(),U(h.$$.fragment),m=p(),b(l,"class","collapse"),b(l,"aria-label","toggle facets group"),b(l,"title","toggle facets group"),v(l,"open",!e[3].includes(e[17])),b(t,"class",$="facet "+e[17]),v(t,"collapsed",e[3].includes(e[17]))},m(i,a){s(i,t,a),c(t,n),c(n,l),c(n,o),c(n,u),c(t,d),z(h,t,null),c(t,m),k=!0,y||(x=g(n,"click",(function(){r(e[7](e[17]))&&e[7](e[17]).apply(this,arguments)})),y=!0)},p(n,r){e=n,24&r&&v(l,"open",!e[3].includes(e[17])),(!k||16&r)&&L!==(L=e[18].label+"")&&w(u,L);const o={};16&r&&(o.group=e[17]),16&r&&(o.label=e[18].label),16&r&&(o.facets=e[18].facets),h.$set(o),(!k||16&r&&$!==($="facet "+e[17]))&&b(t,"class",$),24&r&&v(t,"collapsed",e[3].includes(e[17]))},i(e){k||(T(h.$$.fragment,e),k=!0)},o(e){J(h.$$.fragment,e),k=!1},d(e){e&&i(t),Q(h),y=!1,x()}}}function jt(e){let t,n,r,o,f,h,w,$,y,x,L,O,j,C,F,_,I,S,E,V,D,q,M,A,H;w=new at({props:{count:e[1].length}}),L=new at({props:{count:e[1].length}}),V=new ht({props:{value:e[0].query}}),V.$on("updateQuery",e[13]);let N=e[4],P=[];for(let t=0;t<N.length;t+=1)P[t]=Ot(Lt(e,N,t));const G=e=>J(P[e],1,1,(()=>{P[e]=null}));return{c(){t=a("div"),n=a("button"),r=d("svg"),o=d("path"),f=p(),h=a("span"),U(w.$$.fragment),$=p(),y=a("div"),x=a("h3"),U(L.$$.fragment),O=p(),j=a("span"),C=p(),F=a("button"),_=d("svg"),I=d("path"),E=p(),U(V.$$.fragment),D=p(),q=a("div");for(let e=0;e<P.length;e+=1)P[e].c();b(o,"d","M6,13H18V11H6M3,6V8H21V6M10,18H14V16H10V18Z"),b(r,"viewBox","0 0 24 24"),b(r,"width","24"),b(r,"height","24"),b(h,"class","refine--handler-label"),b(n,"class","refine--handler"),b(j,"class","spacer"),b(I,"fill","currentColor"),b(I,"d","M21 8H3V6H21V8M13.81 16H10V18H13.09C13.21 17.28 13.46 16.61 13.81 16M18 11H6V13H18V11M21.12 15.46L19 17.59L16.88 15.46L15.47 16.88L17.59 19L15.47 21.12L16.88 22.54L19 20.41L21.12 22.54L22.54 21.12L20.41 19L22.54 16.88L21.12 15.46Z"),k(_,"width","24px"),k(_,"height","24px"),b(_,"viewBox","0 0 24 24"),b(F,"aria-label","clear filters"),b(F,"title","clear filters"),F.disabled=S=JSON.stringify(e[0])===JSON.stringify(te),b(q,"class","facets"),b(y,"class","refine--inner"),b(t,"class","refine--wrapper"),v(t,"cropped",e[5])},m(l,i){s(l,t,i),c(t,n),c(n,r),c(r,o),c(n,f),c(n,h),z(w,h,null),c(t,$),c(t,y),c(y,x),z(L,x,null),c(x,O),c(x,j),c(x,C),c(x,F),c(F,_),c(_,I),c(y,E),z(V,y,null),c(y,D),c(y,q);for(let e=0;e<P.length;e+=1)P[e].m(q,null);e[15](t),M=!0,A||(H=[g(n,"click",m(Ct)),g(F,"click",e[12])],A=!0)},p(e,[n]){const l={};2&n&&(l.count=e[1].length),w.$set(l);const r={};2&n&&(r.count=e[1].length),L.$set(r),(!M||1&n&&S!==(S=JSON.stringify(e[0])===JSON.stringify(te)))&&(F.disabled=S);const o={};if(1&n&&(o.value=e[0].query),V.$set(o),152&n){let t;for(N=e[4],t=0;t<N.length;t+=1){const l=Lt(e,N,t);P[t]?(P[t].p(l,n),T(P[t],1)):(P[t]=Ot(l),P[t].c(),T(P[t],1),P[t].m(q,null))}for(B(),t=N.length;t<P.length;t+=1)G(t);R()}32&n&&v(t,"cropped",e[5])},i(e){if(!M){T(w.$$.fragment,e),T(L.$$.fragment,e),T(V.$$.fragment,e);for(let e=0;e<N.length;e+=1)T(P[e]);M=!0}},o(e){J(w.$$.fragment,e),J(L.$$.fragment,e),J(V.$$.fragment,e),P=P.filter(Boolean);for(let e=0;e<P.length;e+=1)J(P[e]);M=!1},d(n){n&&i(t),Q(w),Q(L),Q(V),u(P,n),e[15](null),A=!1,l(H)}}}function Ct(e){document.querySelector(".refine").classList.toggle("open")}function Ft(e,t,n){let l,r,{activeFacets:o=[]}=t,{categories:c={}}=t,{genres:s={}}=t,{publishers:i={}}=t,{state:u={}}=t,{works:a=[]}=t;const d=O();let f,p=[];function h(){const e=function({activeFacets:e=[],categories:t={},genres:n={},publishers:l={},works:r=[]}){const o=r.reduce(((e,t)=>{for(const n of t.facets)e[n]||(e[n]=0),e[n]+=1;return e}),{});return Object.entries(o).reduce(((r,[o,c])=>{const{group:s,value:i}=function(e){const t=e.split(".");return{group:t[0],value:t[1]}}(o);let u=r.findIndex((e=>e.group===s));return-1===u&&(r.push({group:s,def:{collapsed:X[s].collapsed,label:X[s].label,facets:{}}}),u=r.length-1),r[u].def.facets[i]={count:c,value:i,active:e.includes(o),label:X[s].getLabel({value:i,categories:t,genres:n,publishers:l})},r.sort(((e,t)=>X[e.group].order>X[t.group].order?1:-1))}),[])}({activeFacets:o,categories:c,genres:s,publishers:i,works:a});return e.filter((e=>e.def.collapsed)).forEach((e=>{p.includes(e.collapsed)||p.push(e.collapsed)})),e}return e.$$set=e=>{"activeFacets"in e&&n(8,o=e.activeFacets),"categories"in e&&n(9,c=e.categories),"genres"in e&&n(10,s=e.genres),"publishers"in e&&n(11,i=e.publishers),"state"in e&&n(0,u=e.state),"works"in e&&n(1,a=e.works)},e.$$.update=()=>{3842&e.$$.dirty&&n(4,l=h()),6&e.$$.dirty&&n(5,r=function(e,t){if(t)return t.offsetHeight>window.innerHeight}(0,f))},[u,a,f,p,l,r,d,function(e){p.includes(e)?n(3,p=p.filter((t=>t!==e))):n(3,p=[...p,e])},o,c,s,i,()=>d("clear"),function(t){j(e,t)},function(t){j(e,t)},function(e){F[e?"unshift":"push"]((()=>{f=e,n(2,f)}))}]}class _t extends Y{constructor(e){super(),W(this,e,Ft,jt,o,{activeFacets:8,categories:9,genres:10,publishers:11,state:0,works:1})}}function It(t){let n;return{c(){n=a("ul"),b(n,"class","works-pagination")},m(e,t){s(e,n,t)},p:e,i:e,o:e,d(e){e&&i(n)}}}class St extends Y{constructor(e){super(),W(this,e,null,It,o,{})}}function Et(e,t,n){const l=e.slice();return l[18]=t[n],l[3]=n,l}function Vt(t){let n,l,r,o,u,d,h,g=t[20].message+"",m=(console.error(t[20])&&"")+"";return{c(){n=a("p"),l=f("Failed to initialize catalogue: "),r=a("strong"),o=f(g),u=f("."),d=p(),h=f(m)},m(e,t){s(e,n,t),c(n,l),c(n,r),c(r,o),c(n,u),s(e,d,t),s(e,h,t)},p:e,i:e,o:e,d(e){e&&i(n),e&&i(d),e&&i(h)}}}function Dt(e){let t,n,l,r,o,u,d,f,h,g=[],m=new Map,w=e[4];const $=e=>e[18].id;for(let t=0;t<w.length;t+=1){let n=Et(e,w,t),l=$(n);m.set(l,g[t]=qt(l,n))}return u=new _t({props:{activeFacets:e[1].activeFacets,categories:e[17].catalogue.categories,genres:e[17].catalogue.genres,publishers:e[17].catalogue.publishers,state:e[1],works:e[2]}}),u.$on("updateQuery",e[13]),u.$on("refine",e[7]),u.$on("clear",e[8]),f=new St({}),{c(){t=a("div"),n=a("div"),l=a("ul");for(let e=0;e<g.length;e+=1)g[e].c();r=p(),o=a("div"),U(u.$$.fragment),d=p(),U(f.$$.fragment),b(l,"class","works--list"),b(n,"class","column list"),b(o,"class","column refine"),b(t,"class","row")},m(e,i){s(e,t,i),c(t,n),c(n,l);for(let e=0;e<g.length;e+=1)g[e].m(l,null);c(t,r),c(t,o),z(u,o,null),s(e,d,i),z(f,e,i),h=!0},p(e,t){114&t&&(w=e[4],B(),g=function(e,t,n,l,r,o,c,s,i,u,a,d){let f=e.length,p=o.length,h=f;const g={};for(;h--;)g[e[h].key]=h;const m=[],b=new Map,w=new Map;for(h=p;h--;){const e=d(r,o,h),s=n(e);let i=c.get(s);i?l&&i.p(e,t):(i=u(s,e),i.c()),b.set(s,m[h]=i),s in g&&w.set(s,Math.abs(h-g[s]))}const $=new Set,k=new Set;function v(e){T(e,1),e.m(s,a),c.set(e.key,e),a=e.first,p--}for(;f&&p;){const t=m[p-1],n=e[f-1],l=t.key,r=n.key;t===n?(a=t.first,f--,p--):b.has(r)?!c.has(l)||$.has(l)?v(t):k.has(r)?f--:w.get(l)>w.get(r)?(k.add(l),v(t)):($.add(r),f--):(i(n,c),f--)}for(;f--;){const t=e[f];b.has(t.key)||i(t,c)}for(;p;)v(m[p-1]);return m}(g,t,$,1,e,w,m,l,P,qt,null,Et),R());const n={};2&t&&(n.activeFacets=e[1].activeFacets),2&t&&(n.state=e[1]),4&t&&(n.works=e[2]),u.$set(n)},i(e){if(!h){for(let e=0;e<w.length;e+=1)T(g[e]);T(u.$$.fragment,e),T(f.$$.fragment,e),h=!0}},o(e){for(let e=0;e<g.length;e+=1)J(g[e]);J(u.$$.fragment,e),J(f.$$.fragment,e),h=!1},d(e){e&&i(t);for(let e=0;e<g.length;e+=1)g[e].d();Q(u),e&&i(d),Q(f,e)}}}function qt(e,t){let n,l,r;return l=new st({props:{categories:t[17].catalogue.categories,fields:t[17].catalogue.fields,i18n:t[17].i18n,index:t[3],publishers:t[17].catalogue.publishers,reworkActive:Boolean(t[1].reworksOf),showID:t[1].showID,work:t[18]}}),l.$on("selectCategory",t[6]),l.$on("showReworks",t[12]),{key:e,first:null,c(){n=h(),U(l.$$.fragment),this.first=n},m(e,t){s(e,n,t),z(l,e,t),r=!0},p(e,n){t=e;const r={};16&n&&(r.index=t[3]),2&n&&(r.reworkActive=Boolean(t[1].reworksOf)),2&n&&(r.showID=t[1].showID),16&n&&(r.work=t[18]),l.$set(r)},i(e){r||(T(l.$$.fragment,e),r=!0)},o(e){J(l.$$.fragment,e),r=!1},d(e){e&&i(n),Q(l,e)}}}function Mt(t){let n;return{c(){n=a("p"),n.textContent="Loading catalogue data..."},m(e,t){s(e,n,t)},p:e,i:e,o:e,d(e){e&&i(n)}}}function At(e){let t,n,l,r,o,u={ctx:e,current:null,token:null,hasCatch:!0,pending:Mt,then:Dt,catch:Vt,value:17,error:20,blocks:[,,,]};return function(e,t){const n=t.token={};function l(e,l,r,o){if(t.token!==n)return;t.resolved=o;let c=t.ctx;void 0!==r&&(c=c.slice(),c[r]=o);const s=e&&(t.current=e)(c);let i=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==l&&e&&(B(),J(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),R())})):t.block.d(1),s.c(),T(s,1),s.m(t.mount(),t.anchor),i=!0),t.block=s,t.blocks&&(t.blocks[l]=s),i&&M()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=L();if(e.then((e=>{x(n),l(t.then,1,t.value,e),x(null)}),(e=>{if(x(n),l(t.catch,2,t.error,e),x(null),!t.hasCatch)throw e})),t.current!==t.pending)return l(t.pending,0),!0}else{if(t.current!==t.then)return l(t.then,1,t.value,e),!0;t.resolved=e}var r}(e[5](),u),{c(){t=a("form"),n=a("div"),u.block.c(),b(n,"class","works"),b(t,"class","catalogue search")},m(i,a){s(i,t,a),c(t,n),u.block.m(n,u.anchor=null),u.mount=()=>n,u.anchor=null,e[14](t),l=!0,r||(o=g(t,"submit",m(e[11])),r=!0)},p(t,[n]){{const l=(e=t).slice();l[17]=l[20]=u.resolved,u.block.p(l,n)}},i(e){l||(T(u.block),l=!0)},o(e){for(let e=0;e<3;e+=1){J(u.blocks[e])}l=!1},d(n){n&&i(t),u.block.d(),u.token=null,u=null,e[14](null),r=!1,o()}}}function Ht(e,t,n){let l,r,o,c,s=!1,i={},u=[];var a;function d(e){const t=e.detail;n(1,c.activeFacets=c.activeFacets.includes(t)?c.activeFacets.filter((e=>e!==t)):[...c.activeFacets,t],c)}a=()=>{!function(e){let t=e;for(;"section"!==t.tagName.toLowerCase();)t=t.parentNode;t&&(t.style.overflow="hidden")}(document.getElementById("catalogue-app")),n(9,s=!0)},L().$$.on_mount.push(a);return e.$$.update=()=>{523&e.$$.dirty&&(s&&i?(ne(c),se(o)):n(1,c=le())),1034&e.$$.dirty&&n(2,l=function({activeFacets:e,index:t,query:n,reworksOf:l,sort:r,works:o}){let c=o;return l?c=o.filter((e=>e.rework===l)).sort(((e,t)=>e.id===l?-1:1)):(c=function({index:e,query:t,works:n}){if(t.startsWith("id:"))return n.filter((e=>e.id===t.split(":")[1]));{if(!e.search)return n;const l=e.search(t).map((e=>e.ref));return n.filter((e=>l.includes(e.id)))}}({works:o,index:t,query:n}),c=function({activeFacets:e,works:t}){return e.length?t.filter((t=>e.every((e=>t.facets.includes(e))))):t}({activeFacets:e,works:c})),c}({...c,index:i,works:u})),4&e.$$.dirty&&n(4,r=l)},[o,c,l,i,r,async function(){const e={};return await Promise.all(Object.entries(Z).map((([t,n])=>fetch(n).then((e=>e.json())).then((n=>{e[t]=n}))))),n(10,u=function(e=[]){return e.map((e=>({...e,facets:Object.entries(X).reduce(((t,[n,l])=>{const r=l.getValues(e);return r.length&&(t=[...t,...ee(n,r)]),t}),[])})))}(e.catalogue.works)),n(3,i=lunr.Index.load(e.index)),e},function(e){d({detail:ee("c",e.detail)})},d,function(){n(1,c={...te})},s,u,function(t){j(e,t)},e=>n(1,c.reworksOf=c.reworksOf===e.detail?"":e.detail,c),e=>n(1,c.query=e.detail,c),function(e){F[e?"unshift":"push"]((()=>{o=e,n(0,o)}))}]}class Nt extends Y{constructor(e){super(),W(this,e,Ht,At,o,{})}}const Bt=document.getElementById("catalogue-app");let Rt={};return Bt&&(Rt=new Nt({target:Bt})),Rt}();
//# sourceMappingURL=bundle.js.map
