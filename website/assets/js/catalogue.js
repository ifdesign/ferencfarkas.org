var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function i(e){e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function a(e){return document.createElement(e)}function d(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function f(e){return document.createTextNode(e)}function p(){return f(" ")}function h(){return f("")}function g(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function m(e){return function(t){return t.preventDefault(),e.call(this,t)}}function b(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function w(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function $(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function k(e,t){e.value=null==t?"":t}function v(e,t,n,l){e.style.setProperty(t,n,l?"important":"")}function y(e,t,n){e.classList[n?"add":"remove"](t)}let x;function L(e){x=e}function O(){if(!x)throw new Error("Function called outside component initialization");return x}function j(){const e=O();return(t,n)=>{const l=e.$$.callbacks[t];if(l){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach((t=>{t.call(e,r)}))}}}function C(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const F=[],_=[],I=[],S=[],E=Promise.resolve();let V=!1;function D(e){I.push(e)}let q=!1;const M=new Set;function A(){if(!q){q=!0;do{for(let e=0;e<F.length;e+=1){const t=F[e];L(t),H(t.$$)}for(L(null),F.length=0;_.length;)_.pop()();for(let e=0;e<I.length;e+=1){const t=I[e];M.has(t)||(M.add(t),t())}I.length=0}while(F.length);for(;S.length;)S.pop()();V=!1,q=!1,M.clear()}}function H(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}const N=new Set;let B;function R(){B={r:0,c:[],p:B}}function T(){B.r||l(B.c),B=B.p}function P(e,t){e&&e.i&&(N.delete(e),e.i(t))}function J(e,t,n,l){if(e&&e.o){if(N.has(e))return;N.add(e),B.c.push((()=>{N.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}}function U(e,t){J(e,1,1,(()=>{t.delete(e.key)}))}function z(e){e&&e.c()}function Q(e,n,o,c){const{fragment:s,on_mount:i,on_destroy:u,after_update:a}=e.$$;s&&s.m(n,o),c||D((()=>{const n=i.map(t).filter(r);u?u.push(...n):l(n),e.$$.on_mount=[]})),a.forEach(D)}function G(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function W(e,t){-1===e.$$.dirty[0]&&(F.push(e),V||(V=!0,E.then(A)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Y(t,r,o,c,s,u,a=[-1]){const d=x;L(t);const f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:a,skip_bound:!1};let p=!1;if(f.ctx=o?o(t,r.props||{},((e,n,...l)=>{const r=l.length?l[0]:n;return f.ctx&&s(f.ctx[e],f.ctx[e]=r)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](r),p&&W(t,e)),n})):[],f.update(),p=!0,l(f.before_update),f.fragment=!!c&&c(f.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);f.fragment&&f.fragment.l(e),e.forEach(i)}else f.fragment&&f.fragment.c();r.intro&&P(t.$$.fragment),Q(t,r.target,r.anchor,r.customElement),A()}L(d)}class Z{$destroy(){G(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var K={catalogue:"/_catalogue/c.json",index:"/_catalogue/i.json",i18n:"/_catalogue/i18n/en.json"};const X={lt2:{label:"< 2‘ ",compute:e=>e<120},f2t5:{label:"2‘ – 5‘",compute:e=>e>=120&&e<300},f5t15:{label:"5‘ – 15‘",compute:e=>e>=300&&e<900},f15t30:{label:"15‘ – 30‘",compute:e=>e>=900&&e<1800},f30t1h:{label:"30‘ – 1h",compute:e=>e>=1800&&e<3600},f1ht2h:{label:"1h – 2h",compute:e=>e>=3600&&e<=7200},gt2h:{label:"> 2h",compute:e=>e>7200}};var ee={g:{order:1,collapsed:!1,label:"Genres",getValues:e=>[e.genre],getLabel:({value:e,genres:t={}})=>t[e]?.title},c:{order:2,collapsed:!1,label:"Categories",getValues:e=>[e.category],getLabel:({value:e,categories:t={}})=>t[e]?.title},l:{order:3,collapsed:!0,label:"Languages",getValues:e=>Object.keys({...e.texts,...e.libretto}),getLabel:({value:e})=>e.toUpperCase()},p:{order:4,collapsed:!0,label:"Publishers",getValues:e=>e.publications?e.publications.reduce(((e,t)=>{const n=t.publisher_id;return e.includes(n)||e.push(n),e}),[]):["unpublished"],getLabel:({value:e,publishers:t={}})=>"unpublished"===e?"Unpublished":t[e]?.shortName||t[e]?.name},m:{order:5,collapsed:!0,label:"Multimedia",getValues:e=>[],getLabel:({value:e})=>e},t:{order:6,collapsed:!0,label:"Durations",getValues:e=>Object.entries(X).filter((([t,{compute:n}])=>n(e.duration))).map((([e])=>e)),getLabel:({value:e})=>X[e].label},d:{order:7,collapsed:!0,label:"Composition decennies",getValues:e=>{const t=/(19|20)\d{2}/gim;let n;const l=[];for(;null!==(n=t.exec(e.composition_date));)n.index===t.lastIndex&&t.lastIndex++,l.push(n[0]);return l.reduce(((e,t)=>{t.endsWith(0)&&(t-=1);const n=Math.floor(parseInt(t)%1900/10),l=(n>10?`20${n}1 - 20${n+1}0`:9===n?`19${n}1 - 2001`:`19${n}1 - 19${n+1}0`).substr(0,3)+"0s";return e.includes(l)||e.push(l),e}),[])},getLabel:({value:e})=>{const t=parseInt(e.substr(0,4));return[t+1,t+10].join(" - ")}}};function te(e="_",t){const n=t=>`${e}.${t}`;return Array.isArray(t)?[].concat(t).map((e=>n(e))):n(t)}function ne(e){const t=e.split(".");return{group:t[0],value:t[1]}}const le={activeFacets:[],page:1,query:"",reworksOf:"",showID:!1,sort:{field:"title",dir:"asc"}};function re(e){const t=function(e){const t=Object.entries(e).filter((([e,t])=>t)).reduce(((e,[t,n])=>(Array.isArray(n)&&n.length?e.push(`${t}=${n.join(",")}`):"string"==typeof n&&""!==n?e.push(`${t}=${n}`):!0===n&&e.push(`${t}`),e)),[]).join("&");return t&&`?${t}`}({q:e.query,f:e.activeFacets,r:e.reworksOf,showID:e.showID});window.history.replaceState(e,"",`${window.location.pathname}${t}`)}function oe(){const e=window.location.search.split(/[\?&]/).filter((e=>e)).reduce(((e,t)=>{const[n,l]=t.split("=");let r=l?.split(",")||!0;return!0===r?e[n]=!0:1===r.length?e[n]=decodeURIComponent(l):e[n]=r.map((e=>decodeURIComponent(e))),e}),{});return{activeFacets:e.f&&[].concat(e.f)||le.activeFacets,page:e.p||le.page,query:e.q||le.query,reworksOf:e.r||le.reworksOf,showID:e.showID||le.showID,sort:e.s?.split(".").reduce(((e,t,n)=>(0===n?e.field=t:e.dir=t,e)),{})||le.sort}}let ce,se,ie;function ue(e){setTimeout((()=>{ce=e.querySelector(".refine--wrapper"),se=e.querySelector(".refine--inner"),ie=e.querySelector(".works--list")}),200),window.addEventListener("scroll",ae),window.addEventListener("resize",ae)}function ae(){if(!ce||!ie||!se)return;const e=se.getBoundingClientRect(),t=ie.getBoundingClientRect();t.top>0?(ce.classList.remove("sticked"),ce.classList.remove("scrolled")):t.bottom>=e.height?(ce.classList.add("sticked"),ce.classList.remove("scrolled")):(ce.classList.add("scrolled"),ce.classList.remove("sticked"))}function de(e,t,n){const l=e.slice();return l[6]=t[n].key,l[7]=t[n].value,l}function fe(e,t,n){const l=e.slice();return l[23]=t[n],l}function pe(e,t,n){const l=e.slice();return l[20]=t[n],l}function he(e,t,n){const l=e.slice();return l[17]=t[n],l[19]=n,l}function ge(e,t,n){const l=e.slice();return l[14]=t[n],l}function me(e,t,n){const l=e.slice();return l[10]=t[n].role,l[11]=t[n].voice,l}function be(t){let n,l=t[7]+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function we(e){let t;let n=function(e,t){return e[7].credits?Oe:Le}(e)(e);return{c(){n.c(),t=h()},m(e,l){n.m(e,l),s(e,t,l)},p(e,t){n.p(e,t)},d(e){n.d(e),e&&i(t)}}}function $e(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Ce(pe(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(6&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=pe(e,n,o);l[o]?l[o].p(c,r):(l[o]=Ce(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ke(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Fe(he(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c();w(t,"class","movements")},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=he(e,n,o);l[o]?l[o].p(c,r):(l[o]=Fe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ve(e){let t,n=Object.values(e[7]),l=[];for(let t=0;t<n.length;t+=1)l[t]=_e(ge(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=Object.values(e[7]),o=0;o<n.length;o+=1){const c=ge(e,n,o);l[o]?l[o].p(c,r):(l[o]=_e(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function ye(t){let n,l=Ve(t[7])+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function xe(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Ie(me(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=me(e,n,o);l[o]?l[o].p(c,r):(l[o]=Ie(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function Le(t){let n,l=De(t[7])+"";return{c(){n=f(l)},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function Oe(e){let t,n,l,r,o=De(e[7])+"",d=e[7].credits,h=[];for(let t=0;t<d.length;t+=1)h[t]=je(fe(e,d,t));return{c(){t=a("ul"),n=a("li"),l=f(o),r=p();for(let e=0;e<h.length;e+=1)h[e].c()},m(e,o){s(e,t,o),c(t,n),c(n,l),c(t,r);for(let e=0;e<h.length;e+=1)h[e].m(t,null)},p(e,n){if(4&n){let l;for(d=e[7].credits,l=0;l<d.length;l+=1){const r=fe(e,d,l);h[l]?h[l].p(r,n):(h[l]=je(r),h[l].c(),h[l].m(t,null))}for(;l<h.length;l+=1)h[l].d(1);h.length=d.length}},d(e){e&&i(t),u(h,e)}}}function je(t){let n,l,r=t[23]+"";return{c(){n=a("li"),l=f(r)},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}function Ce(t){let n,l,r,o,u,d=t[1][t[20].publisher_id].name+"",h="all"!==t[20].type&&function(t){let n,l,r,o=t[20].type+"";return{c(){n=a("span"),l=f(o),r=f(":")},m(e,t){s(e,n,t),c(n,l),c(n,r)},p:e,d(e){e&&i(n)}}}(t);return{c(){n=a("li"),h&&h.c(),l=p(),r=a("a"),o=f(d),u=p(),w(r,"href","#"),w(r,"class","link")},m(e,t){s(e,n,t),h&&h.m(n,null),c(n,l),c(n,r),c(r,o),c(n,u)},p(e,t){"all"!==e[20].type&&h.p(e,t),2&t&&d!==(d=e[1][e[20].publisher_id].name+"")&&$(o,d)},d(e){e&&i(n),h&&h.d()}}}function Fe(t){let n,l,r,o,u,d,h,g,m,b=t[19]+1+"",$=t[17].title+"",k=t[17].duration&&function(t){let n,l,r=Ve(t[17].duration)+"";return{c(){n=a("span"),l=f(r),w(n,"class","movement--duration")},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}(t);return{c(){n=a("li"),l=a("span"),r=f(b),o=f(")"),u=p(),d=a("span"),h=f($),g=p(),k&&k.c(),m=p(),w(l,"class","movement--pos"),w(d,"class","movement--title"),w(n,"class","movement")},m(e,t){s(e,n,t),c(n,l),c(l,r),c(l,o),c(n,u),c(n,d),c(d,h),c(n,g),k&&k.m(n,null),c(n,m)},p(e,t){e[17].duration&&k.p(e,t)},d(e){e&&i(n),k&&k.d()}}}function _e(t){let n,l,r=t[14]+"";return{c(){n=a("li"),l=f(r)},m(e,t){s(e,n,t),c(n,l)},p:e,d(e){e&&i(n)}}}function Ie(t){let n,l,r,o,u,d,h=t[10]+"",g=t[11]+"";return{c(){n=a("li"),l=f(h),r=f(" - "),o=a("span"),u=f(g),d=p()},m(e,t){s(e,n,t),c(n,l),c(n,r),c(n,o),c(o,u),c(n,d)},p:e,d(e){e&&i(n)}}}function Se(e){let t,n,l,r,o,u,d=e[0].fields[e[6]]+"";let h=function(e,t){return"cast"===e[6]?xe:"duration"===e[6]?ye:"libretto"===e[6]||"texts"===e[6]?ve:"movements"===e[6]?ke:"publications"===e[6]?$e:"world_premiere"===e[6]?we:be}(e)(e);return{c(){t=a("div"),n=a("dt"),l=f(d),r=p(),o=a("dd"),h.c(),u=p(),w(n,"class",e[6]),w(t,"class","work--field")},m(e,i){s(e,t,i),c(t,n),c(n,l),c(t,r),c(t,o),h.m(o,null),c(t,u)},p(e,t){1&t&&d!==(d=e[0].fields[e[6]]+"")&&$(l,d),h.p(e,t)},d(e){e&&i(t),h.d()}}}function Ee(t){let n,l=t[2],r=[];for(let e=0;e<l.length;e+=1)r[e]=Se(de(t,l,e));return{c(){n=a("dl");for(let e=0;e<r.length;e+=1)r[e].c();w(n,"class","work--fields")},m(e,t){s(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,[t]){if(7&t){let o;for(l=e[2],o=0;o<l.length;o+=1){const c=de(e,l,o);r[o]?r[o].p(c,t):(r[o]=Se(c),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=l.length}},i:e,o:e,d(e){e&&i(n),u(r,e)}}}function Ve(e){const t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),l=Math.floor(e-3600*t-60*n);let r="";return t>0&&(r+=`${t}h `),n>0&&(r+=`${n}‘ `),l>0&&(r+=`${l}”`),r}function De({date:e,location:t}){let n=[];return e&&(e.toString().includes("T")&&(e=function(e){return new Date(e).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric"})}(e)),n.push(e)),t&&n.push(t),n.join(" - ")}function qe(e,t,n){let{fields:l=[]}=t,{i18n:r={}}=t,{publishers:o={}}=t,{work:c={}}=t;const s=["audios","category","date","default","description","facets","filtered","genre","id","isDefaultVersion","rework","rework_of","story","title","versions","works"],i=Object.entries(c).filter((([e])=>!s.includes(e))).sort(((e,t)=>{const n=l.indexOf(e[0]),r=l.indexOf(t[0]);return n>r?1:n<r?-1:0})).map((([e,t])=>({key:e,value:t})));return e.$$set=e=>{"fields"in e&&n(3,l=e.fields),"i18n"in e&&n(0,r=e.i18n),"publishers"in e&&n(1,o=e.publishers),"work"in e&&n(4,c=e.work)},[r,o,i,l,c]}class Me extends Z{constructor(e){super(),Y(this,e,qe,Ee,o,{fields:3,i18n:0,publishers:1,work:4})}}function Ae(e,t,n){const l=e.slice();return l[23]=t[n],l}function He(e,t,n){const l=e.slice();return l[26]=t[n],l}function Ne(e,t,n){const l=e.slice();return l[29]=t[n],l}function Be(e){let t,n,l,r,o,u,d,p,h,b,k,v;return{c(){t=a("div"),n=a("p"),l=f("You are seeing the list of works that have been reworked based on\n        "),r=a("strong"),o=f(e[12]),u=f(".\n        "),d=a("br"),p=f("\n        You can go "),h=a("button"),h.textContent="back to the previous list",b=f(' by\n        clicking ony any of the "Rework" / "Reworked" buttons.'),w(h,"class","link back"),w(t,"class","work--rework-info")},m(i,a){s(i,t,a),c(t,n),c(n,l),c(n,r),c(r,o),c(n,u),c(n,d),c(n,p),c(n,h),c(n,b),k||(v=g(h,"click",m(e[16])),k=!0)},p(e,t){4096&t[0]&&$(o,e[12])},d(e){e&&i(t),k=!1,v()}}}function Re(e){let t,n,l,r,o=e[8].id+"";return{c(){t=a("button"),n=f(o),w(t,"class","work--id")},m(o,i){s(o,t,i),c(t,n),l||(r=g(t,"click",b(e[18])),l=!0)},p(e,t){256&t[0]&&o!==(o=e[8].id+"")&&$(n,o)},d(e){e&&i(t),l=!1,r()}}}function Te(e){let t,n,l,r,o=e[0][e[8].category].tag+"";return{c(){t=a("button"),n=f(o),w(t,"class","tag"),t.disabled=e[6]},m(o,i){s(o,t,i),c(t,n),l||(r=g(t,"click",b(m(e[19]))),l=!0)},p(e,l){257&l[0]&&o!==(o=e[0][e[8].category].tag+"")&&$(n,o),64&l[0]&&(t.disabled=e[6])},d(e){e&&i(t),l=!1,r()}}}function Pe(e){let t,n,l,r;function o(e,t){return e[11]?Ue:Je}let c=o(e),u=c(e);return{c(){t=a("button"),u.c(),w(t,"class",n="tag border rework"+(e[9]?"":"ed")),y(t,"active",e[6])},m(n,o){s(n,t,o),u.m(t,null),l||(r=g(t,"click",b(m(e[16]))),l=!0)},p(e,l){c===(c=o(e))&&u?u.p(e,l):(u.d(1),u=c(e),u&&(u.c(),u.m(t,null))),512&l[0]&&n!==(n="tag border rework"+(e[9]?"":"ed"))&&w(t,"class",n),576&l[0]&&y(t,"active",e[6])},d(e){e&&i(t),u.d(),l=!1,r()}}}function Je(e){let t,n,l=e[9]?"":"ed";return{c(){t=f("Rework"),n=f(l)},m(e,l){s(e,t,l),s(e,n,l)},p(e,t){512&t[0]&&l!==(l=e[9]?"":"ed")&&$(n,l)},d(e){e&&i(t),e&&i(n)}}}function Ue(t){let n;return{c(){n=f("Reworked")},m(e,t){s(e,n,t)},p:e,d(e){e&&i(n)}}}function ze(e){let t,n,l,r,o,u=(e[8].texts||e[8].libretto)&&Qe(e),d=e[8].title.sort.length>1&&We(e);return{c(){t=a("h3"),n=a("span"),l=f(e[12]),r=p(),u&&u.c(),o=p(),d&&d.c(),w(t,"class","work--title")},m(e,i){s(e,t,i),c(t,n),c(n,l),c(t,r),u&&u.m(t,null),c(t,o),d&&d.m(t,null)},p(e,n){4096&n[0]&&$(l,e[12]),e[8].texts||e[8].libretto?u?u.p(e,n):(u=Qe(e),u.c(),u.m(t,o)):u&&(u.d(1),u=null),e[8].title.sort.length>1?d?d.p(e,n):(d=We(e),d.c(),d.m(t,null)):d&&(d.d(1),d=null)},d(e){e&&i(t),u&&u.d(),d&&d.d()}}}function Qe(e){let t,n=Object.keys({...e[8].texts,...e[8].libretto}),l=[];for(let t=0;t<n.length;t+=1)l[t]=Ge(Ne(e,n,t));return{c(){t=a("ul");for(let e=0;e<l.length;e+=1)l[e].c();w(t,"class","work--languages")},m(e,n){s(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(256&r[0]){let o;for(n=Object.keys({...e[8].texts,...e[8].libretto}),o=0;o<n.length;o+=1){const c=Ne(e,n,o);l[o]?l[o].p(c,r):(l[o]=Ge(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&i(t),u(l,e)}}}function Ge(e){let t,n,l=e[29]+"";return{c(){t=a("li"),n=f(l)},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[29]+"")&&$(n,l)},d(e){e&&i(t)}}}function We(e){let t,n,l=e[8].title.sort.filter(e[20]).map(e[21]).join(" / ")+"";return{c(){t=a("div"),n=f(l),w(t,"class","work--title-translations")},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[8].title.sort.filter(e[20]).map(e[21]).join(" / ")+"")&&$(n,l)},d(e){e&&i(t)}}}function Ye(e){let t,n,l,r=e[8].description+"",o=e[8].note&&Ze(e);return{c(){t=a("div"),n=f(r),l=p(),o&&o.c(),w(t,"class","work--description")},m(e,r){s(e,t,r),c(t,n),c(t,l),o&&o.m(t,null)},p(e,l){256&l[0]&&r!==(r=e[8].description+"")&&$(n,r),e[8].note?o?o.p(e,l):(o=Ze(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&i(t),o&&o.d()}}}function Ze(e){let t,n,l=e[8].note+"";return{c(){t=a("div"),n=f(l),w(t,"class","work--note")},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[8].note+"")&&$(n,l)},d(e){e&&i(t)}}}function Ke(e){let t,n,l=e[8].version+"";return{c(){t=a("div"),n=f(l),w(t,"class","work--version")},m(e,l){s(e,t,l),c(t,n)},p(e,t){256&t[0]&&l!==(l=e[8].version+"")&&$(n,l)},d(e){e&&i(t)}}}function Xe(e){let t,n;return t=new Me({props:{work:e[8],fields:e[1],i18n:e[2],publishers:e[5]}}),{c(){z(t.$$.fragment)},m(e,l){Q(t,e,l),n=!0},p(e,n){const l={};256&n[0]&&(l.work=e[8]),2&n[0]&&(l.fields=e[1]),4&n[0]&&(l.i18n=e[2]),32&n[0]&&(l.publishers=e[5]),t.$set(l)},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){G(t,e)}}}function et(e){let t,n,l=e[8].versions,r=[];for(let t=0;t<l.length;t+=1)r[t]=tt(He(e,l,t));const o=e=>J(r[e],1,1,(()=>{r[e]=null}));return{c(){t=a("ul");for(let e=0;e<r.length;e+=1)r[e].c();w(t,"class","works--list")},m(e,l){s(e,t,l);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,n){if(295&n[0]){let c;for(l=e[8].versions,c=0;c<l.length;c+=1){const o=He(e,l,c);r[c]?(r[c].p(o,n),P(r[c],1)):(r[c]=tt(o),r[c].c(),P(r[c],1),r[c].m(t,null))}for(R(),c=l.length;c<r.length;c+=1)o(c);T()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)P(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)J(r[e]);n=!1},d(e){e&&i(t),u(r,e)}}}function tt(e){let t,n;return t=new ut({props:{work:e[26],isSub:!0,categories:e[0],fields:e[1],i18n:e[2],publishers:e[5]}}),{c(){z(t.$$.fragment)},m(e,l){Q(t,e,l),n=!0},p(e,n){const l={};256&n[0]&&(l.work=e[26]),1&n[0]&&(l.categories=e[0]),2&n[0]&&(l.fields=e[1]),4&n[0]&&(l.i18n=e[2]),32&n[0]&&(l.publishers=e[5]),t.$set(l)},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){J(t.$$.fragment,e),n=!1},d(e){G(t,e)}}}function nt(e){let t,n,l=e[8].story&&lt(e),r=e[8].audios&&rt(e);return{c(){t=a("div"),l&&l.c(),n=p(),r&&r.c(),w(t,"class","work--multimedia")},m(e,o){s(e,t,o),l&&l.m(t,null),c(t,n),r&&r.m(t,null)},p(e,o){e[8].story?l?l.p(e,o):(l=lt(e),l.c(),l.m(t,n)):l&&(l.d(1),l=null),e[8].audios?r?r.p(e,o):(r=rt(e),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(e){e&&i(t),l&&l.d(),r&&r.d()}}}function lt(e){let t,n,l;return{c(){t=a("a"),n=f("About the work"),w(t,"class","link work--story"),w(t,"href",l=e[8].story)},m(e,l){s(e,t,l),c(t,n)},p(e,n){256&n[0]&&l!==(l=e[8].story)&&w(t,"href",l)},d(e){e&&i(t)}}}function rt(e){let t,n=e[8].audios,l=[];for(let t=0;t<n.length;t+=1)l[t]=ot(Ae(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=h()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);s(e,t,n)},p(e,r){if(256&r[0]){let o;for(n=e[8].audios,o=0;o<n.length;o+=1){const c=Ae(e,n,o);l[o]?l[o].p(c,r):(l[o]=ot(c),l[o].c(),l[o].m(t.parentNode,t))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){u(l,e),e&&i(t)}}}function ot(e){let t,n,l,r,o,u,d,h,b,k,v,y=e[23].description+"";function x(...t){return e[22](e[23],...t)}return{c(){t=a("button"),n=a("div"),l=p(),r=a("div"),o=a("h5"),u=f(y),d=p(),w(n,"class","play--button"),w(r,"class","play--meta"),w(t,"class","play small"),w(t,"data-audio",h=e[23].id),w(t,"data-title",b=e[23].description)},m(e,i){s(e,t,i),c(t,n),c(t,l),c(t,r),c(r,o),c(o,u),c(t,d),k||(v=g(t,"click",m(x)),k=!0)},p(n,l){e=n,256&l[0]&&y!==(y=e[23].description+"")&&$(u,y),256&l[0]&&h!==(h=e[23].id)&&w(t,"data-audio",h),256&l[0]&&b!==(b=e[23].description)&&w(t,"data-title",b)},d(e){e&&i(t),k=!1,v()}}}function ct(e){let t;return{c(){t=a("div"),t.textContent="Reworks",w(t,"class","work--rework-label")},m(e,n){s(e,t,n)},d(e){e&&i(t)}}}function st(e){let t,n,l,r,o,u,d,f,h,m,b,$,k,v,x,L,O,j,C=e[11]&&Be(e),F=e[7]&&e[8].id&&Re(e),_=e[8].category&&Te(e),I=e[8].rework&&Pe(e),S=e[8].title&&ze(e),E=e[8].description&&Ye(e),V=e[8].version&&!e[8].isDefaultVersion&&Ke(e),D=e[1].length&&Xe(e),q=e[8].versions&&et(e),M=(e[8].story||e[8].audios)&&nt(e),A=e[11]&&ct();return{c(){t=a("li"),C&&C.c(),n=p(),l=a("div"),F&&F.c(),r=p(),_&&_.c(),o=p(),I&&I.c(),u=p(),S&&S.c(),d=p(),E&&E.c(),f=p(),V&&V.c(),h=p(),D&&D.c(),m=p(),q&&q.c(),b=p(),M&&M.c(),k=p(),A&&A.c(),w(l,"class",$="work--"+(e[4]?"sub":"container")),y(l,"open",e[10]),y(l,"black",e[11]),y(l,"selected",e[13]),w(t,"class","work"),w(t,"id",v=e[8].id),w(t,"data-index",x=e[11]?"":e[6]?e[3]:e[3]+1)},m(i,a){s(i,t,a),C&&C.m(t,null),c(t,n),c(t,l),F&&F.m(l,null),c(l,r),_&&_.m(l,null),c(l,o),I&&I.m(l,null),c(l,u),S&&S.m(l,null),c(l,d),E&&E.m(l,null),c(l,f),V&&V.m(l,null),c(l,h),D&&D.m(l,null),c(l,m),q&&q.m(l,null),c(l,b),M&&M.m(l,null),c(t,k),A&&A.m(t,null),L=!0,O||(j=g(l,"click",e[15]),O=!0)},p(e,c){e[11]?C?C.p(e,c):(C=Be(e),C.c(),C.m(t,n)):C&&(C.d(1),C=null),e[7]&&e[8].id?F?F.p(e,c):(F=Re(e),F.c(),F.m(l,r)):F&&(F.d(1),F=null),e[8].category?_?_.p(e,c):(_=Te(e),_.c(),_.m(l,o)):_&&(_.d(1),_=null),e[8].rework?I?I.p(e,c):(I=Pe(e),I.c(),I.m(l,u)):I&&(I.d(1),I=null),e[8].title?S?S.p(e,c):(S=ze(e),S.c(),S.m(l,d)):S&&(S.d(1),S=null),e[8].description?E?E.p(e,c):(E=Ye(e),E.c(),E.m(l,f)):E&&(E.d(1),E=null),e[8].version&&!e[8].isDefaultVersion?V?V.p(e,c):(V=Ke(e),V.c(),V.m(l,h)):V&&(V.d(1),V=null),e[1].length?D?(D.p(e,c),2&c[0]&&P(D,1)):(D=Xe(e),D.c(),P(D,1),D.m(l,m)):D&&(R(),J(D,1,1,(()=>{D=null})),T()),e[8].versions?q?(q.p(e,c),256&c[0]&&P(q,1)):(q=et(e),q.c(),P(q,1),q.m(l,b)):q&&(R(),J(q,1,1,(()=>{q=null})),T()),e[8].story||e[8].audios?M?M.p(e,c):(M=nt(e),M.c(),M.m(l,null)):M&&(M.d(1),M=null),(!L||16&c[0]&&$!==($="work--"+(e[4]?"sub":"container")))&&w(l,"class",$),1040&c[0]&&y(l,"open",e[10]),2064&c[0]&&y(l,"black",e[11]),8208&c[0]&&y(l,"selected",e[13]),e[11]?A||(A=ct(),A.c(),A.m(t,null)):A&&(A.d(1),A=null),(!L||256&c[0]&&v!==(v=e[8].id))&&w(t,"id",v),(!L||2120&c[0]&&x!==(x=e[11]?"":e[6]?e[3]:e[3]+1))&&w(t,"data-index",x)},i(e){L||(P(D),P(q),L=!0)},o(e){J(D),J(q),L=!1},d(e){e&&i(t),C&&C.d(),F&&F.d(),_&&_.d(),I&&I.d(),S&&S.d(),E&&E.d(),V&&V.d(),D&&D.d(),q&&q.d(),M&&M.d(),A&&A.d(),O=!1,j()}}}function it(e,t,n){let l,r,o,c,{categories:s={}}=t,{fields:i=[]}=t,{i18n:u={}}=t,{index:a=-1}=t,{isSub:d=!1}=t,{publishers:f={}}=t,{reworkActive:p=!1}=t,{showID:h=!1}=t,{work:g={}}=t;const m=j();let b=!1,w=!1;return e.$$set=e=>{"categories"in e&&n(0,s=e.categories),"fields"in e&&n(1,i=e.fields),"i18n"in e&&n(2,u=e.i18n),"index"in e&&n(3,a=e.index),"isSub"in e&&n(4,d=e.isSub),"publishers"in e&&n(5,f=e.publishers),"reworkActive"in e&&n(6,p=e.reworkActive),"showID"in e&&n(7,h=e.showID),"work"in e&&n(8,g=e.work)},e.$$.update=()=>{256&e.$$.dirty[0]&&n(9,l=g.rework!==g.id),576&e.$$.dirty[0]&&n(11,r=p&&!l),256&e.$$.dirty[0]&&n(12,o=g.title?.translations[g.title?.main]),131136&e.$$.dirty[0]&&n(13,c=w&&p)},[s,i,u,a,d,f,p,h,g,l,b,r,o,c,m,function(){n(10,b=!b)},function(){n(17,w=!p),m("showReworks",g.rework||g.id)},w,e=>navigator.clipboard.writeText(e.target.textContent),()=>m("selectCategory",g.category),e=>e!==g.title.main,e=>g.title.translations[e],(e,t)=>{window.dispatchEvent(new window.CustomEvent("play",{detail:{target:t.target,audio:e.id}}))}]}class ut extends Z{constructor(e){super(),Y(this,e,it,st,o,{categories:0,fields:1,i18n:2,index:3,isSub:4,publishers:5,reworkActive:6,showID:7,work:8},[-1,-1])}}function at(t){let n,l,r;return{c(){n=f("Filter works\n"),l=a("span"),r=f(t[0]),w(l,"class","tag works--count")},m(e,t){s(e,n,t),s(e,l,t),c(l,r)},p(e,[t]){1&t&&$(r,e[0])},i:e,o:e,d(e){e&&i(n),e&&i(l)}}}function dt(e,t,n){let{count:l=0}=t;return e.$$set=e=>{"count"in e&&n(0,l=e.count)},[l]}class ft extends Z{constructor(e){super(),Y(this,e,dt,at,o,{count:0})}}function pt(e){let t;return{c(){t=a("div"),t.innerHTML='<label class="inline"><input type="checkbox" name="title"/>\n        Title</label> \n      <label class="inline"><input type="checkbox" name="description"/>\n        Description</label> \n      <label class="inline"><input type="checkbox" name="version"/>\n        Version</label> \n      <label class="inline"><input type="checkbox" name="composition-date"/>\n        Composition date</label> \n      <label class="inline"><input type="checkbox" name="composition-location"/>\n        Composition location</label>',w(t,"class","search--fields-wrapper")},m(e,n){s(e,t,n)},d(e){e&&i(t)}}}function ht(t){let n,r,o,u,d,f,h,m,b=t[1]&&pt();return{c(){n=a("div"),r=a("div"),o=a("input"),u=p(),d=a("button"),d.textContent="Search",f=p(),b&&b.c(),w(o,"type","search"),w(o,"name","q"),w(o,"placeholder","Filter with keywords"),w(d,"type","submit"),w(r,"class","search--query-wrapper"),y(r,"focused",t[2]),w(n,"class","search--query")},m(e,l){s(e,n,l),c(n,r),c(r,o),k(o,t[0]),c(r,u),c(r,d),c(n,f),b&&b.m(n,null),h||(m=[g(o,"input",t[3]),g(o,"focus",t[4]),g(o,"blur",t[5])],h=!0)},p(e,[t]){1&t&&k(o,e[0]),4&t&&y(r,"focused",e[2]),e[1]?b||(b=pt(),b.c(),b.m(n,null)):b&&(b.d(1),b=null)},i:e,o:e,d(e){e&&i(n),b&&b.d(),h=!1,l(m)}}}function gt(e,t,n){let{showFields:l=!1}=t,{value:r=""}=t;const o=j();let c=!1;return e.$$set=e=>{"showFields"in e&&n(1,l=e.showFields),"value"in e&&n(0,r=e.value)},e.$$.update=()=>{1&e.$$.dirty&&o("updateQuery",r)},[r,l,c,function(){r=this.value,n(0,r)},()=>n(2,c=!0),()=>n(2,c=!1)]}class mt extends Z{constructor(e){super(),Y(this,e,gt,ht,o,{showFields:1,value:0})}}function bt(e,t,n){const l=e.slice();return l[9]=t[n].value,l[10]=t[n].facet,l[11]=t,l[12]=n,l}function wt(e){let t,n,r,o,u,d,h,m,b,k,v,y,x,L=e[10].label+"",O=e[10].count+"";function j(){e[6].call(r,e[11],e[12])}function C(){return e[7](e[9])}return{c(){t=a("li"),n=a("label"),r=a("input"),u=p(),d=a("span"),h=f(L),m=p(),b=a("span"),k=f(O),v=p(),w(r,"type","checkbox"),w(r,"name",o=te(e[0],e[9])),w(d,"class","facet--name"),w(b,"class","facet--count")},m(l,o){s(l,t,o),c(t,n),c(n,r),r.checked=e[10].active,c(n,u),c(n,d),c(d,h),c(n,m),c(n,b),c(b,k),c(t,v),y||(x=[g(r,"change",j),g(r,"click",C)],y=!0)},p(t,n){e=t,17&n&&o!==(o=te(e[0],e[9]))&&w(r,"name",o),16&n&&(r.checked=e[10].active),16&n&&L!==(L=e[10].label+"")&&$(h,L),16&n&&O!==(O=e[10].count+"")&&$(k,O)},d(e){e&&i(t),y=!1,l(x)}}}function $t(e){let t,n,l;function r(e,t){return e[3]?vt:kt}let o=r(e),c=o(e);return{c(){t=a("button"),c.c(),w(t,"class","link facet--more")},m(r,o){s(r,t,o),c.m(t,null),n||(l=g(t,"click",m(e[8])),n=!0)},p(e,n){o===(o=r(e))&&c?c.p(e,n):(c.d(1),c=o(e),c&&(c.c(),c.m(t,null)))},d(e){e&&i(t),c.d(),n=!1,l()}}}function kt(e){let t,n,l,r,o,c=e[1].toLowerCase()+"",u=Object.keys(e[2]).length-xt+"";return{c(){t=f("Show more "),n=f(c),l=f(" ("),r=f(u),o=f(")")},m(e,c){s(e,t,c),s(e,n,c),s(e,l,c),s(e,r,c),s(e,o,c)},p(e,t){2&t&&c!==(c=e[1].toLowerCase()+"")&&$(n,c),4&t&&u!==(u=Object.keys(e[2]).length-xt+"")&&$(r,u)},d(e){e&&i(t),e&&i(n),e&&i(l),e&&i(r),e&&i(o)}}}function vt(e){let t,n,l,r,o=e[1].toLowerCase()+"";return{c(){t=f("Show first "),n=f(xt),l=p(),r=f(o)},m(e,o){s(e,t,o),s(e,n,o),s(e,l,o),s(e,r,o)},p(e,t){2&t&&o!==(o=e[1].toLowerCase()+"")&&$(r,o)},d(e){e&&i(t),e&&i(n),e&&i(l),e&&i(r)}}}function yt(t){let n,l,r,o=Object.keys(t[2]).length>xt,c=t[4],d=[];for(let e=0;e<c.length;e+=1)d[e]=wt(bt(t,c,e));let f=o&&$t(t);return{c(){n=a("ul");for(let e=0;e<d.length;e+=1)d[e].c();l=p(),f&&f.c(),r=h()},m(e,t){s(e,n,t);for(let e=0;e<d.length;e+=1)d[e].m(n,null);s(e,l,t),f&&f.m(e,t),s(e,r,t)},p(e,[t]){if(49&t){let l;for(c=e[4],l=0;l<c.length;l+=1){const r=bt(e,c,l);d[l]?d[l].p(r,t):(d[l]=wt(r),d[l].c(),d[l].m(n,null))}for(;l<d.length;l+=1)d[l].d(1);d.length=c.length}4&t&&(o=Object.keys(e[2]).length>xt),o?f?f.p(e,t):(f=$t(e),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:e,o:e,d(e){e&&i(n),u(d,e),e&&i(l),f&&f.d(e),e&&i(r)}}}const xt=5;function Lt(e,t,n){let l,{group:r=""}=t,{label:o=""}=t,{facets:c={}}=t;const s=j();let i=!1;return e.$$set=e=>{"group"in e&&n(0,r=e.group),"label"in e&&n(1,o=e.label),"facets"in e&&n(2,c=e.facets)},e.$$.update=()=>{12&e.$$.dirty&&n(4,l=function(e){return Object.entries(e).sort(((e,t)=>t[1].count>e[1].count?1:-1)).map((([e,t])=>({value:e,facet:t})))}(c).slice(0,i?c.length:xt))},[r,o,c,i,l,s,function(e,t){e[t].facet.active=this.checked,n(4,l),n(2,c),n(3,i)},e=>s("refine",te(r,e)),()=>{n(3,i=!i)}]}class Ot extends Z{constructor(e){super(),Y(this,e,Lt,yt,o,{group:0,label:1,facets:2})}}function jt(e,t,n){const l=e.slice();return l[17]=t[n].group,l[18]=t[n].def,l}function Ct(e){let t,n,l,o,u,d,h,m,b,k,v,x,L=e[18].label+"";return h=new Ot({props:{group:e[17],label:e[18].label,facets:e[18].facets}}),h.$on("refine",e[14]),{c(){t=a("div"),n=a("h4"),l=a("button"),o=p(),u=f(L),d=p(),z(h.$$.fragment),m=p(),w(l,"class","collapse"),w(l,"aria-label","toggle facets group"),w(l,"title","toggle facets group"),y(l,"open",!e[3].includes(e[17])),w(t,"class",b="facet "+e[17]),y(t,"collapsed",e[3].includes(e[17]))},m(i,a){s(i,t,a),c(t,n),c(n,l),c(n,o),c(n,u),c(t,d),Q(h,t,null),c(t,m),k=!0,v||(x=g(n,"click",(function(){r(e[7](e[17]))&&e[7](e[17]).apply(this,arguments)})),v=!0)},p(n,r){e=n,24&r&&y(l,"open",!e[3].includes(e[17])),(!k||16&r)&&L!==(L=e[18].label+"")&&$(u,L);const o={};16&r&&(o.group=e[17]),16&r&&(o.label=e[18].label),16&r&&(o.facets=e[18].facets),h.$set(o),(!k||16&r&&b!==(b="facet "+e[17]))&&w(t,"class",b),24&r&&y(t,"collapsed",e[3].includes(e[17]))},i(e){k||(P(h.$$.fragment,e),k=!0)},o(e){J(h.$$.fragment,e),k=!1},d(e){e&&i(t),G(h),v=!1,x()}}}function Ft(e){let t,n,r,o,f,h,b,$,k,x,L,O,j,C,F,_,I,S,E,V,D,q,M,A,H;b=new ft({props:{count:e[1].length}}),L=new ft({props:{count:e[1].length}}),V=new mt({props:{value:e[0].query}}),V.$on("updateQuery",e[13]);let N=e[4],B=[];for(let t=0;t<N.length;t+=1)B[t]=Ct(jt(e,N,t));const U=e=>J(B[e],1,1,(()=>{B[e]=null}));return{c(){t=a("div"),n=a("button"),r=d("svg"),o=d("path"),f=p(),h=a("span"),z(b.$$.fragment),$=p(),k=a("div"),x=a("h3"),z(L.$$.fragment),O=p(),j=a("span"),C=p(),F=a("button"),_=d("svg"),I=d("path"),E=p(),z(V.$$.fragment),D=p(),q=a("div");for(let e=0;e<B.length;e+=1)B[e].c();w(o,"d","M6,13H18V11H6M3,6V8H21V6M10,18H14V16H10V18Z"),w(r,"viewBox","0 0 24 24"),w(r,"width","24"),w(r,"height","24"),w(h,"class","refine--handler-label"),w(n,"class","refine--handler"),w(j,"class","spacer"),w(I,"fill","currentColor"),w(I,"d","M21 8H3V6H21V8M13.81 16H10V18H13.09C13.21 17.28 13.46 16.61 13.81 16M18 11H6V13H18V11M21.12 15.46L19 17.59L16.88 15.46L15.47 16.88L17.59 19L15.47 21.12L16.88 22.54L19 20.41L21.12 22.54L22.54 21.12L20.41 19L22.54 16.88L21.12 15.46Z"),v(_,"width","24px"),v(_,"height","24px"),w(_,"viewBox","0 0 24 24"),w(F,"aria-label","clear filters"),w(F,"title","clear filters"),F.disabled=S=JSON.stringify(e[0])===JSON.stringify(le),w(q,"class","facets"),w(k,"class","refine--inner"),w(t,"class","refine--wrapper"),y(t,"cropped",e[5])},m(l,i){s(l,t,i),c(t,n),c(n,r),c(r,o),c(n,f),c(n,h),Q(b,h,null),c(t,$),c(t,k),c(k,x),Q(L,x,null),c(x,O),c(x,j),c(x,C),c(x,F),c(F,_),c(_,I),c(k,E),Q(V,k,null),c(k,D),c(k,q);for(let e=0;e<B.length;e+=1)B[e].m(q,null);e[15](t),M=!0,A||(H=[g(n,"click",m(_t)),g(F,"click",e[12])],A=!0)},p(e,[n]){const l={};2&n&&(l.count=e[1].length),b.$set(l);const r={};2&n&&(r.count=e[1].length),L.$set(r),(!M||1&n&&S!==(S=JSON.stringify(e[0])===JSON.stringify(le)))&&(F.disabled=S);const o={};if(1&n&&(o.value=e[0].query),V.$set(o),152&n){let t;for(N=e[4],t=0;t<N.length;t+=1){const l=jt(e,N,t);B[t]?(B[t].p(l,n),P(B[t],1)):(B[t]=Ct(l),B[t].c(),P(B[t],1),B[t].m(q,null))}for(R(),t=N.length;t<B.length;t+=1)U(t);T()}32&n&&y(t,"cropped",e[5])},i(e){if(!M){P(b.$$.fragment,e),P(L.$$.fragment,e),P(V.$$.fragment,e);for(let e=0;e<N.length;e+=1)P(B[e]);M=!0}},o(e){J(b.$$.fragment,e),J(L.$$.fragment,e),J(V.$$.fragment,e),B=B.filter(Boolean);for(let e=0;e<B.length;e+=1)J(B[e]);M=!1},d(n){n&&i(t),G(b),G(L),G(V),u(B,n),e[15](null),A=!1,l(H)}}}function _t(e){document.querySelector(".refine").classList.toggle("open")}function It(e,t,n){let l,r,{activeFacets:o=[]}=t,{categories:c={}}=t,{genres:s={}}=t,{publishers:i={}}=t,{state:u={}}=t,{works:a=[]}=t;const d=j();let f,p;function h(){const e=function({activeFacets:e=[],categories:t={},genres:n={},publishers:l={},works:r=[]}){const o=r.reduce(((e,t)=>{for(const n of t.facets)e[n]||(e[n]=0),e[n]+=1;return e}),{});return Object.entries(o).reduce(((r,[o,c])=>{const{group:s,value:i}=ne(o);let u=r.findIndex((e=>e.group===s));return-1===u&&(r.push({group:s,def:{collapsed:ee[s].collapsed,label:ee[s].label,facets:{}}}),u=r.length-1),r[u].def.facets[i]={count:c,value:i,active:e.includes(o),label:ee[s].getLabel({value:i,categories:t,genres:n,publishers:l})},r.sort(((e,t)=>ee[e.group].order>ee[t.group].order?1:-1))}),[])}({activeFacets:o,categories:c,genres:s,publishers:i,works:a});return f||n(3,f=e.filter((e=>e.def.collapsed)).map((e=>e.group))),u.activeFacets.map((e=>ne(e).group)).forEach((e=>{f.includes(e)&&n(3,f=f.filter((t=>t!==e)))})),e}return e.$$set=e=>{"activeFacets"in e&&n(8,o=e.activeFacets),"categories"in e&&n(9,c=e.categories),"genres"in e&&n(10,s=e.genres),"publishers"in e&&n(11,i=e.publishers),"state"in e&&n(0,u=e.state),"works"in e&&n(1,a=e.works)},e.$$.update=()=>{3842&e.$$.dirty&&n(4,l=h()),6&e.$$.dirty&&n(5,r=function(e,t){if(t)return t.offsetHeight>window.innerHeight}(0,p))},[u,a,p,f,l,r,d,function(e){f.includes(e)?n(3,f=f.filter((t=>t!==e))):n(3,f=[...f,e]),console.log(f)},o,c,s,i,()=>d("clear"),function(t){C(e,t)},function(t){C(e,t)},function(e){_[e?"unshift":"push"]((()=>{p=e,n(2,p)}))}]}class St extends Z{constructor(e){super(),Y(this,e,It,Ft,o,{activeFacets:8,categories:9,genres:10,publishers:11,state:0,works:1})}}function Et(t){let n;return{c(){n=a("ul"),w(n,"class","works-pagination")},m(e,t){s(e,n,t)},p:e,i:e,o:e,d(e){e&&i(n)}}}class Vt extends Z{constructor(e){super(),Y(this,e,null,Et,o,{})}}function Dt(e,t,n){const l=e.slice();return l[18]=t[n],l[3]=n,l}function qt(t){let n,l,r,o,u,d,h,g=t[20].message+"",m=(console.error(t[20])&&"")+"";return{c(){n=a("p"),l=f("Failed to initialize catalogue: "),r=a("strong"),o=f(g),u=f("."),d=p(),h=f(m)},m(e,t){s(e,n,t),c(n,l),c(n,r),c(r,o),c(n,u),s(e,d,t),s(e,h,t)},p:e,i:e,o:e,d(e){e&&i(n),e&&i(d),e&&i(h)}}}function Mt(e){let t,n,l,r,o,u,d,f,h,g=[],m=new Map,b=e[4];const $=e=>e[18].id;for(let t=0;t<b.length;t+=1){let n=Dt(e,b,t),l=$(n);m.set(l,g[t]=At(l,n))}return u=new St({props:{activeFacets:e[1].activeFacets,categories:e[17].catalogue.categories,genres:e[17].catalogue.genres,publishers:e[17].catalogue.publishers,state:e[1],works:e[2]}}),u.$on("updateQuery",e[13]),u.$on("refine",e[7]),u.$on("clear",e[8]),f=new Vt({}),{c(){t=a("div"),n=a("div"),l=a("ul");for(let e=0;e<g.length;e+=1)g[e].c();r=p(),o=a("div"),z(u.$$.fragment),d=p(),z(f.$$.fragment),w(l,"class","works--list"),w(n,"class","column list"),w(o,"class","column refine"),w(t,"class","row")},m(e,i){s(e,t,i),c(t,n),c(n,l);for(let e=0;e<g.length;e+=1)g[e].m(l,null);c(t,r),c(t,o),Q(u,o,null),s(e,d,i),Q(f,e,i),h=!0},p(e,t){114&t&&(b=e[4],R(),g=function(e,t,n,l,r,o,c,s,i,u,a,d){let f=e.length,p=o.length,h=f;const g={};for(;h--;)g[e[h].key]=h;const m=[],b=new Map,w=new Map;for(h=p;h--;){const e=d(r,o,h),s=n(e);let i=c.get(s);i?l&&i.p(e,t):(i=u(s,e),i.c()),b.set(s,m[h]=i),s in g&&w.set(s,Math.abs(h-g[s]))}const $=new Set,k=new Set;function v(e){P(e,1),e.m(s,a),c.set(e.key,e),a=e.first,p--}for(;f&&p;){const t=m[p-1],n=e[f-1],l=t.key,r=n.key;t===n?(a=t.first,f--,p--):b.has(r)?!c.has(l)||$.has(l)?v(t):k.has(r)?f--:w.get(l)>w.get(r)?(k.add(l),v(t)):($.add(r),f--):(i(n,c),f--)}for(;f--;){const t=e[f];b.has(t.key)||i(t,c)}for(;p;)v(m[p-1]);return m}(g,t,$,1,e,b,m,l,U,At,null,Dt),T());const n={};2&t&&(n.activeFacets=e[1].activeFacets),2&t&&(n.state=e[1]),4&t&&(n.works=e[2]),u.$set(n)},i(e){if(!h){for(let e=0;e<b.length;e+=1)P(g[e]);P(u.$$.fragment,e),P(f.$$.fragment,e),h=!0}},o(e){for(let e=0;e<g.length;e+=1)J(g[e]);J(u.$$.fragment,e),J(f.$$.fragment,e),h=!1},d(e){e&&i(t);for(let e=0;e<g.length;e+=1)g[e].d();G(u),e&&i(d),G(f,e)}}}function At(e,t){let n,l,r;return l=new ut({props:{categories:t[17].catalogue.categories,fields:t[17].catalogue.fields,i18n:t[17].i18n,index:t[3],publishers:t[17].catalogue.publishers,reworkActive:Boolean(t[1].reworksOf),showID:t[1].showID,work:t[18]}}),l.$on("selectCategory",t[6]),l.$on("showReworks",t[12]),{key:e,first:null,c(){n=h(),z(l.$$.fragment),this.first=n},m(e,t){s(e,n,t),Q(l,e,t),r=!0},p(e,n){t=e;const r={};16&n&&(r.index=t[3]),2&n&&(r.reworkActive=Boolean(t[1].reworksOf)),2&n&&(r.showID=t[1].showID),16&n&&(r.work=t[18]),l.$set(r)},i(e){r||(P(l.$$.fragment,e),r=!0)},o(e){J(l.$$.fragment,e),r=!1},d(e){e&&i(n),G(l,e)}}}function Ht(t){let n;return{c(){n=a("p"),n.textContent="Loading catalogue data..."},m(e,t){s(e,n,t)},p:e,i:e,o:e,d(e){e&&i(n)}}}function Nt(e){let t,n,l,r,o,u={ctx:e,current:null,token:null,hasCatch:!0,pending:Ht,then:Mt,catch:qt,value:17,error:20,blocks:[,,,]};return function(e,t){const n=t.token={};function l(e,l,r,o){if(t.token!==n)return;t.resolved=o;let c=t.ctx;void 0!==r&&(c=c.slice(),c[r]=o);const s=e&&(t.current=e)(c);let i=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==l&&e&&(R(),J(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),T())})):t.block.d(1),s.c(),P(s,1),s.m(t.mount(),t.anchor),i=!0),t.block=s,t.blocks&&(t.blocks[l]=s),i&&A()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=O();if(e.then((e=>{L(n),l(t.then,1,t.value,e),L(null)}),(e=>{if(L(n),l(t.catch,2,t.error,e),L(null),!t.hasCatch)throw e})),t.current!==t.pending)return l(t.pending,0),!0}else{if(t.current!==t.then)return l(t.then,1,t.value,e),!0;t.resolved=e}var r}(e[5](),u),{c(){t=a("form"),n=a("div"),u.block.c(),w(n,"class","works"),w(t,"class","catalogue search")},m(i,a){s(i,t,a),c(t,n),u.block.m(n,u.anchor=null),u.mount=()=>n,u.anchor=null,e[14](t),l=!0,r||(o=g(t,"submit",m(e[11])),r=!0)},p(t,[n]){{const l=(e=t).slice();l[17]=l[20]=u.resolved,u.block.p(l,n)}},i(e){l||(P(u.block),l=!0)},o(e){for(let e=0;e<3;e+=1){J(u.blocks[e])}l=!1},d(n){n&&i(t),u.block.d(),u.token=null,u=null,e[14](null),r=!1,o()}}}function Bt(e,t,n){let l,r,o,c,s=!1,i={},u=[];var a;function d(e){const t=e.detail;n(1,c.activeFacets=c.activeFacets.includes(t)?c.activeFacets.filter((e=>e!==t)):[...c.activeFacets,t],c)}a=()=>{!function(e){let t=e;for(;"section"!==t.tagName.toLowerCase();)t=t.parentNode;t&&(t.style.overflow="hidden")}(document.getElementById("catalogue-app")),n(9,s=!0)},O().$$.on_mount.push(a);return e.$$.update=()=>{523&e.$$.dirty&&(s&&i?(re(c),ue(o)):n(1,c=oe())),1034&e.$$.dirty&&n(2,l=function({activeFacets:e,index:t,query:n,reworksOf:l,sort:r,works:o}){let c=o;return l?c=o.filter((e=>e.rework===l)).sort(((e,t)=>e.id===l?-1:1)):(c=function({index:e,query:t,works:n}){if(t.startsWith("id:"))return n.filter((e=>e.id===t.split(":")[1]));{if(!e.search)return n;const l=e.search(t).map((e=>e.ref));return n.filter((e=>l.includes(e.id)))}}({works:o,index:t,query:n}),c=function({activeFacets:e,works:t}){return e.length?t.filter((t=>e.every((e=>t.facets.includes(e))))):t}({activeFacets:e,works:c})),c}({...c,index:i,works:u})),4&e.$$.dirty&&n(4,r=l),4&e.$$.dirty&&function(e){if(ie){const t=window.setInterval((()=>{ie.children.length===e.length&&(window.clearInterval(t),ie.scrollIntoView())}),10)}}(l)},[o,c,l,i,r,async function(){const e={};return await Promise.all(Object.entries(K).map((([t,n])=>fetch(n).then((e=>e.json())).then((n=>{e[t]=n}))))),n(10,u=function(e=[]){return e.map((e=>({...e,facets:Object.entries(ee).reduce(((t,[n,l])=>{const r=l.getValues(e);return r.length&&(t=[...t,...te(n,r)]),t}),[])})))}(e.catalogue.works)),n(3,i=lunr.Index.load(e.index)),e},function(e){d({detail:te("c",e.detail)})},d,function(){n(1,c={...le})},s,u,function(t){C(e,t)},e=>n(1,c.reworksOf=c.reworksOf===e.detail?"":e.detail,c),e=>n(1,c.query=e.detail,c),function(e){_[e?"unshift":"push"]((()=>{o=e,n(0,o)}))}]}class Rt extends Z{constructor(e){super(),Y(this,e,Bt,Nt,o,{})}}const Tt=document.getElementById("catalogue-app");let Pt={};return Tt&&(Pt=new Rt({target:Tt})),Pt}();
//# sourceMappingURL=bundle.js.map
