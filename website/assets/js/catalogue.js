var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function l(){return Object.create(null)}function r(e){e.forEach(n)}function o(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(e,t){e.appendChild(t)}function i(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function a(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function p(){return d(" ")}function h(){return d("")}function g(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function m(e){return function(t){return t.preventDefault(),e.call(this,t)}}function b(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function k(e,t){e.value=null==t?"":t}function $(e,t,n){e.classList[n?"add":"remove"](t)}let v;function y(e){v=e}function x(){if(!v)throw new Error("Function called outside component initialization");return v}function j(){const e=x();return(t,n)=>{const l=e.$$.callbacks[t];if(l){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);l.slice().forEach((t=>{t.call(e,r)}))}}}function O(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const C=[],_=[],F=[],L=[],I=Promise.resolve();let D=!1;function E(e){F.push(e)}let q=!1;const S=new Set;function V(){if(!q){q=!0;do{for(let e=0;e<C.length;e+=1){const t=C[e];y(t),A(t.$$)}for(y(null),C.length=0;_.length;)_.pop()();for(let e=0;e<F.length;e+=1){const t=F[e];S.has(t)||(S.add(t),t())}F.length=0}while(C.length);for(;L.length;)L.pop()();D=!1,q=!1,S.clear()}}function A(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(E)}}const M=new Set;let R;function B(){R={r:0,c:[],p:R}}function H(){R.r||r(R.c),R=R.p}function N(e,t){e&&e.i&&(M.delete(e),e.i(t))}function T(e,t,n,l){if(e&&e.o){if(M.has(e))return;M.add(e),R.c.push((()=>{M.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}}function U(e,t){T(e,1,1,(()=>{t.delete(e.key)}))}function P(e){e&&e.c()}function Q(e,t,l){const{fragment:c,on_mount:s,on_destroy:i,after_update:u}=e.$$;c&&c.m(t,l),E((()=>{const t=s.map(n).filter(o);i?i.push(...t):r(t),e.$$.on_mount=[]})),u.forEach(E)}function z(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function G(e,t){-1===e.$$.dirty[0]&&(C.push(e),D||(D=!0,I.then(V)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function W(t,n,o,c,s,i,a=[-1]){const f=v;y(t);const d=t.$$={fragment:null,ctx:null,props:i,update:e,not_equal:s,bound:l(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:l(),dirty:a,skip_bound:!1};let p=!1;if(d.ctx=o?o(t,n.props||{},((e,n,...l)=>{const r=l.length?l[0]:n;return d.ctx&&s(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),p&&G(t,e)),n})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!c&&c(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(u)}else d.fragment&&d.fragment.c();n.intro&&N(t.$$.fragment),Q(t,n.target,n.anchor),V()}y(f)}class Y{$destroy(){z(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Z={catalogue:"/_catalogue/c.json",index:"/_catalogue/i.json",i18n:"/_catalogue/i18n/en.json"};const J={lt2:{label:"< 2‘ ",compute:e=>e<120},f2t5:{label:"2‘ – 5‘",compute:e=>e>=120&&e<300},f5t15:{label:"5‘ – 15‘",compute:e=>e>=300&&e<900},f15t30:{label:"15‘ – 30‘",compute:e=>e>=900&&e<1800},f30t1h:{label:"30‘ – 1h",compute:e=>e>=1800&&e<3600},f1ht2h:{label:"1h – 2h",compute:e=>e>=3600&&e<=7200},gt2h:{label:"> 2h",compute:e=>e>7200}};var K={g:{order:1,label:"Genres",getValues:e=>[e.genre],getLabel:({value:e,genres:t={}})=>t[e]?.title},c:{order:2,label:"Categories",getValues:e=>[e.category],getLabel:({value:e,categories:t={}})=>t[e]?.title},l:{order:3,label:"Languages",getValues:e=>Object.keys({...e.texts,...e.libretto}),getLabel:({value:e})=>e.toUpperCase()},p:{order:4,label:"Publishers",getValues:e=>e.publications?e.publications.reduce(((e,t)=>{const n=t.publisher_id;return e.includes(n)||e.push(n),e}),[]):["unpublished"],getLabel:({value:e,publishers:t={}})=>"unpublished"===e?"Unpublished":t[e]?.shortName||t[e]?.name},m:{order:5,label:"Multimedia",getValues:e=>[],getLabel:({value:e})=>e},t:{order:6,label:"Durations",getValues:e=>Object.entries(J).filter((([t,{compute:n}])=>n(e.duration))).map((([e])=>e)),getLabel:({value:e})=>J[e].label},d:{order:7,label:"Composition decennies",getValues:e=>{const t=/(19|20)\d{2}/gim;let n;const l=[];for(;null!==(n=t.exec(e.composition_date));)n.index===t.lastIndex&&t.lastIndex++,l.push(n[0]);return l.reduce(((e,t)=>{t.endsWith(0)&&(t-=1);const n=Math.floor(parseInt(t)%1900/10),l=(n>10?`20${n}1 - 20${n+1}0`:9===n?`19${n}1 - 2001`:`19${n}1 - 19${n+1}0`).substr(0,3)+"0s";return e.includes(l)||e.push(l),e}),[])},getLabel:({value:e})=>{const t=parseInt(e.substr(0,4));return[t+1,t+10].join(" - ")}}};function X(e="_",t){const n=t=>`${e}.${t}`;return Array.isArray(t)?[].concat(t).map((e=>n(e))):n(t)}const ee={activeFacets:[],page:1,query:"",reworksOf:"",showID:!1,sort:{field:"title",dir:"asc"}};function te(e){const t=function(e){const t=Object.entries(e).filter((([e,t])=>t)).reduce(((e,[t,n])=>(Array.isArray(n)&&n.length?e.push(`${t}=${n.join(",")}`):"string"==typeof n&&""!==n?e.push(`${t}=${n}`):!0===n&&e.push(`${t}`),e)),[]).join("&");return t&&`?${t}`}({q:e.query,f:e.activeFacets,r:e.reworksOf,showID:e.showID});window.history.replaceState(e,"",`${window.location.pathname}${t}`)}function ne(){const e=window.location.search.split(/[\?&]/).filter((e=>e)).reduce(((e,t)=>{const[n,l]=t.split("=");let r=l?.split(",")||!0;return!0===r?e[n]=!0:1===r.length?e[n]=decodeURIComponent(l):e[n]=r.map((e=>decodeURIComponent(e))),e}),{});return{activeFacets:e.f&&[].concat(e.f)||ee.activeFacets,page:e.p||ee.page,query:e.q||ee.query,reworksOf:e.r||ee.reworksOf,showID:e.showID||ee.showID,sort:e.s?.split(".").reduce(((e,t,n)=>(0===n?e.field=t:e.dir=t,e)),{})||ee.sort}}function le(e){let t;return{c(){t=f("div"),t.innerHTML='<label class="inline"><input type="checkbox" name="title"/>\n      Title</label> \n    <label class="inline"><input type="checkbox" name="description"/>\n      Description</label> \n    <label class="inline"><input type="checkbox" name="version"/>\n      Version</label> \n    <label class="inline"><input type="checkbox" name="composition-date"/>\n      Composition date</label> \n    <label class="inline"><input type="checkbox" name="composition-location"/>\n      Composition location</label>',b(t,"class","search--fields-wrapper")},m(e,n){i(e,t,n)},d(e){e&&u(t)}}}function re(t){let n,l,o,c,a,d,m,w,v=t[1]&&le();return{c(){n=f("div"),l=f("input"),o=p(),c=f("button"),c.textContent="Search",a=p(),v&&v.c(),d=h(),b(l,"type","search"),b(l,"name","q"),b(l,"placeholder","Filter works with keywords"),b(c,"type","submit"),b(n,"class","search--query-wrapper"),$(n,"focused",t[2])},m(e,r){i(e,n,r),s(n,l),k(l,t[0]),s(n,o),s(n,c),i(e,a,r),v&&v.m(e,r),i(e,d,r),m||(w=[g(l,"input",t[4]),g(l,"focus",t[5]),g(l,"blur",t[6]),g(c,"click",t[7])],m=!0)},p(e,[t]){1&t&&k(l,e[0]),4&t&&$(n,"focused",e[2]),e[1]?v||(v=le(),v.c(),v.m(d.parentNode,d)):v&&(v.d(1),v=null)},i:e,o:e,d(e){e&&u(n),e&&u(a),v&&v.d(e),e&&u(d),m=!1,r(w)}}}function oe(e,t,n){let{value:l=""}=t,{showFields:r=!1}=t;const o=j();let c=!1;return e.$$set=e=>{"value"in e&&n(0,l=e.value),"showFields"in e&&n(1,r=e.showFields)},e.$$.update=()=>{1&e.$$.dirty&&""===l&&o("updateQuery",l)},[l,r,c,o,function(){l=this.value,n(0,l)},()=>n(2,c=!0),()=>n(2,c=!1),()=>o("updateQuery",l)]}class ce extends Y{constructor(e){super(),W(this,e,oe,re,c,{value:0,showFields:1})}}function se(e,t,n){const l=e.slice();return l[6]=t[n].key,l[7]=t[n].value,l}function ie(e,t,n){const l=e.slice();return l[23]=t[n],l}function ue(e,t,n){const l=e.slice();return l[20]=t[n],l}function ae(e,t,n){const l=e.slice();return l[17]=t[n],l[19]=n,l}function fe(e,t,n){const l=e.slice();return l[14]=t[n],l}function de(e,t,n){const l=e.slice();return l[10]=t[n].role,l[11]=t[n].voice,l}function pe(t){let n,l=t[7]+"";return{c(){n=d(l)},m(e,t){i(e,n,t)},p:e,d(e){e&&u(n)}}}function he(e){let t;let n=function(e,t){return e[7].credits?ve:$e}(e)(e);return{c(){n.c(),t=h()},m(e,l){n.m(e,l),i(e,t,l)},p(e,t){n.p(e,t)},d(e){n.d(e),e&&u(t)}}}function ge(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=xe(ue(e,n,t));return{c(){t=f("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){i(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(6&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=ue(e,n,o);l[o]?l[o].p(c,r):(l[o]=xe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&u(t),a(l,e)}}}function me(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=je(ae(e,n,t));return{c(){t=f("ul");for(let e=0;e<l.length;e+=1)l[e].c();b(t,"class","movements")},m(e,n){i(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=ae(e,n,o);l[o]?l[o].p(c,r):(l[o]=je(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&u(t),a(l,e)}}}function be(e){let t,n=Object.values(e[7]),l=[];for(let t=0;t<n.length;t+=1)l[t]=Oe(fe(e,n,t));return{c(){t=f("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){i(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=Object.values(e[7]),o=0;o<n.length;o+=1){const c=fe(e,n,o);l[o]?l[o].p(c,r):(l[o]=Oe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&u(t),a(l,e)}}}function we(t){let n,l=Le(t[7])+"";return{c(){n=d(l)},m(e,t){i(e,n,t)},p:e,d(e){e&&u(n)}}}function ke(e){let t,n=e[7],l=[];for(let t=0;t<n.length;t+=1)l[t]=Ce(de(e,n,t));return{c(){t=f("ul");for(let e=0;e<l.length;e+=1)l[e].c()},m(e,n){i(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(4&r){let o;for(n=e[7],o=0;o<n.length;o+=1){const c=de(e,n,o);l[o]?l[o].p(c,r):(l[o]=Ce(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&u(t),a(l,e)}}}function $e(t){let n,l=Ie(t[7])+"";return{c(){n=d(l)},m(e,t){i(e,n,t)},p:e,d(e){e&&u(n)}}}function ve(e){let t,n,l,r,o=Ie(e[7])+"",c=e[7].credits,h=[];for(let t=0;t<c.length;t+=1)h[t]=ye(ie(e,c,t));return{c(){t=f("ul"),n=f("li"),l=d(o),r=p();for(let e=0;e<h.length;e+=1)h[e].c()},m(e,o){i(e,t,o),s(t,n),s(n,l),s(t,r);for(let e=0;e<h.length;e+=1)h[e].m(t,null)},p(e,n){if(4&n){let l;for(c=e[7].credits,l=0;l<c.length;l+=1){const r=ie(e,c,l);h[l]?h[l].p(r,n):(h[l]=ye(r),h[l].c(),h[l].m(t,null))}for(;l<h.length;l+=1)h[l].d(1);h.length=c.length}},d(e){e&&u(t),a(h,e)}}}function ye(t){let n,l,r=t[23]+"";return{c(){n=f("li"),l=d(r)},m(e,t){i(e,n,t),s(n,l)},p:e,d(e){e&&u(n)}}}function xe(t){let n,l,r,o,c,a=t[1][t[20].publisher_id].name+"",h="all"!==t[20].type&&function(t){let n,l,r,o=t[20].type+"";return{c(){n=f("span"),l=d(o),r=d(":")},m(e,t){i(e,n,t),s(n,l),s(n,r)},p:e,d(e){e&&u(n)}}}(t);return{c(){n=f("li"),h&&h.c(),l=p(),r=f("a"),o=d(a),c=p(),b(r,"href","#"),b(r,"class","link")},m(e,t){i(e,n,t),h&&h.m(n,null),s(n,l),s(n,r),s(r,o),s(n,c)},p(e,t){"all"!==e[20].type&&h.p(e,t),2&t&&a!==(a=e[1][e[20].publisher_id].name+"")&&w(o,a)},d(e){e&&u(n),h&&h.d()}}}function je(t){let n,l,r,o,c,a,h,g,m,w=t[19]+1+"",k=t[17].title+"",$=t[17].duration&&function(t){let n,l,r=Le(t[17].duration)+"";return{c(){n=f("span"),l=d(r),b(n,"class","movement--duration")},m(e,t){i(e,n,t),s(n,l)},p:e,d(e){e&&u(n)}}}(t);return{c(){n=f("li"),l=f("span"),r=d(w),o=d(")"),c=p(),a=f("span"),h=d(k),g=p(),$&&$.c(),m=p(),b(l,"class","movement--pos"),b(a,"class","movement--title"),b(n,"class","movement")},m(e,t){i(e,n,t),s(n,l),s(l,r),s(l,o),s(n,c),s(n,a),s(a,h),s(n,g),$&&$.m(n,null),s(n,m)},p(e,t){e[17].duration&&$.p(e,t)},d(e){e&&u(n),$&&$.d()}}}function Oe(t){let n,l,r=t[14]+"";return{c(){n=f("li"),l=d(r)},m(e,t){i(e,n,t),s(n,l)},p:e,d(e){e&&u(n)}}}function Ce(t){let n,l,r,o,c,a,h=t[10]+"",g=t[11]+"";return{c(){n=f("li"),l=d(h),r=d(" - "),o=f("span"),c=d(g),a=p()},m(e,t){i(e,n,t),s(n,l),s(n,r),s(n,o),s(o,c),s(n,a)},p:e,d(e){e&&u(n)}}}function _e(e){let t,n,l,r,o,c,a=e[0].fields[e[6]]+"";let h=function(e,t){return"cast"===e[6]?ke:"duration"===e[6]?we:"libretto"===e[6]||"texts"===e[6]?be:"movements"===e[6]?me:"publications"===e[6]?ge:"world_premiere"===e[6]?he:pe}(e)(e);return{c(){t=f("div"),n=f("dt"),l=d(a),r=p(),o=f("dd"),h.c(),c=p(),b(n,"class",e[6]),b(t,"class","work--field")},m(e,u){i(e,t,u),s(t,n),s(n,l),s(t,r),s(t,o),h.m(o,null),s(t,c)},p(e,t){1&t&&a!==(a=e[0].fields[e[6]]+"")&&w(l,a),h.p(e,t)},d(e){e&&u(t),h.d()}}}function Fe(t){let n,l=t[2],r=[];for(let e=0;e<l.length;e+=1)r[e]=_e(se(t,l,e));return{c(){n=f("dl");for(let e=0;e<r.length;e+=1)r[e].c();b(n,"class","work--fields")},m(e,t){i(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,[t]){if(7&t){let o;for(l=e[2],o=0;o<l.length;o+=1){const c=se(e,l,o);r[o]?r[o].p(c,t):(r[o]=_e(c),r[o].c(),r[o].m(n,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=l.length}},i:e,o:e,d(e){e&&u(n),a(r,e)}}}function Le(e){const t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),l=Math.floor(e-3600*t-60*n);let r="";return t>0&&(r+=`${t}h `),n>0&&(r+=`${n}‘ `),l>0&&(r+=`${l}”`),r}function Ie({date:e,location:t}){let n=[];return e&&(e.toString().includes("T")&&(e=function(e){return new Date(e).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric"})}(e)),n.push(e)),t&&n.push(t),n.join(" - ")}function De(e,t,n){let{fields:l=[]}=t,{i18n:r={}}=t,{publishers:o={}}=t,{work:c={}}=t;const s=["audios","category","date","default","description","facets","filtered","genre","id","isDefaultVersion","rework","rework_of","story","title","versions","works"],i=Object.entries(c).filter((([e])=>!s.includes(e))).sort(((e,t)=>{const n=l.indexOf(e[0]),r=l.indexOf(t[0]);return n>r?1:n<r?-1:0})).map((([e,t])=>({key:e,value:t})));return e.$$set=e=>{"fields"in e&&n(3,l=e.fields),"i18n"in e&&n(0,r=e.i18n),"publishers"in e&&n(1,o=e.publishers),"work"in e&&n(4,c=e.work)},[r,o,i,l,c]}class Ee extends Y{constructor(e){super(),W(this,e,De,Fe,c,{fields:3,i18n:0,publishers:1,work:4})}}function qe(e,t,n){const l=e.slice();return l[22]=t[n],l}function Se(e,t,n){const l=e.slice();return l[25]=t[n],l}function Ve(e,t,n){const l=e.slice();return l[28]=t[n],l}function Ae(e){let t,n,l,r,o,c,a,p,h,k,$,v;return{c(){t=f("div"),n=f("p"),l=d("You are seeing the list of works that have been reworked based on\n        "),r=f("strong"),o=d(e[11]),c=d(".\n        "),a=f("br"),p=d("\n        You can go "),h=f("button"),h.textContent="back to the previous list",k=d(' by\n        clicking ony any of the "Rework" / "Reworked" buttons.'),b(h,"class","link back"),b(t,"class","work--rework-info")},m(u,f){i(u,t,f),s(t,n),s(n,l),s(n,r),s(r,o),s(n,c),s(n,a),s(n,p),s(n,h),s(n,k),$||(v=g(h,"click",m(e[15])),$=!0)},p(e,t){2048&t&&w(o,e[11])},d(e){e&&u(t),$=!1,v()}}}function Me(e){let t,n,l,r,o=e[7].id+"";return{c(){t=f("button"),n=d(o),b(t,"class","work--id")},m(o,c){i(o,t,c),s(t,n),l||(r=g(t,"click",e[17]),l=!0)},p(e,t){128&t&&o!==(o=e[7].id+"")&&w(n,o)},d(e){e&&u(t),l=!1,r()}}}function Re(e){let t,n,l,r,o=e[0][e[7].category].tag+"";return{c(){t=f("button"),n=d(o),b(t,"class","tag"),t.disabled=e[5]},m(o,c){i(o,t,c),s(t,n),l||(r=g(t,"click",m(e[18])),l=!0)},p(e,l){129&l&&o!==(o=e[0][e[7].category].tag+"")&&w(n,o),32&l&&(t.disabled=e[5])},d(e){e&&u(t),l=!1,r()}}}function Be(e){let t,n,l,r;function o(e,t){return e[10]?Ne:He}let c=o(e),s=c(e);return{c(){t=f("button"),s.c(),b(t,"class",n="tag border rework"+(e[8]?"":"ed")),$(t,"active",e[5])},m(n,o){i(n,t,o),s.m(t,null),l||(r=g(t,"click",m(e[15])),l=!0)},p(e,l){c===(c=o(e))&&s?s.p(e,l):(s.d(1),s=c(e),s&&(s.c(),s.m(t,null))),256&l&&n!==(n="tag border rework"+(e[8]?"":"ed"))&&b(t,"class",n),288&l&&$(t,"active",e[5])},d(e){e&&u(t),s.d(),l=!1,r()}}}function He(e){let t,n,l=e[8]?"":"ed";return{c(){t=d("Rework"),n=d(l)},m(e,l){i(e,t,l),i(e,n,l)},p(e,t){256&t&&l!==(l=e[8]?"":"ed")&&w(n,l)},d(e){e&&u(t),e&&u(n)}}}function Ne(t){let n;return{c(){n=d("Reworked")},m(e,t){i(e,n,t)},p:e,d(e){e&&u(n)}}}function Te(e){let t,n,l,r,o,c,a,h=(e[7].texts||e[7].libretto)&&Ue(e),m=e[7].title.sort.length>1&&Qe(e);return{c(){t=f("h3"),n=f("span"),l=d(e[11]),r=p(),h&&h.c(),o=p(),m&&m.c(),b(t,"class","work--title")},m(u,f){i(u,t,f),s(t,n),s(n,l),s(t,r),h&&h.m(t,null),s(t,o),m&&m.m(t,null),c||(a=g(t,"click",e[14]),c=!0)},p(e,n){2048&n&&w(l,e[11]),e[7].texts||e[7].libretto?h?h.p(e,n):(h=Ue(e),h.c(),h.m(t,o)):h&&(h.d(1),h=null),e[7].title.sort.length>1?m?m.p(e,n):(m=Qe(e),m.c(),m.m(t,null)):m&&(m.d(1),m=null)},d(e){e&&u(t),h&&h.d(),m&&m.d(),c=!1,a()}}}function Ue(e){let t,n=Object.keys({...e[7].texts,...e[7].libretto}),l=[];for(let t=0;t<n.length;t+=1)l[t]=Pe(Ve(e,n,t));return{c(){t=f("ul");for(let e=0;e<l.length;e+=1)l[e].c();b(t,"class","work--languages")},m(e,n){i(e,t,n);for(let e=0;e<l.length;e+=1)l[e].m(t,null)},p(e,r){if(128&r){let o;for(n=Object.keys({...e[7].texts,...e[7].libretto}),o=0;o<n.length;o+=1){const c=Ve(e,n,o);l[o]?l[o].p(c,r):(l[o]=Pe(c),l[o].c(),l[o].m(t,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){e&&u(t),a(l,e)}}}function Pe(e){let t,n,l=e[28]+"";return{c(){t=f("li"),n=d(l)},m(e,l){i(e,t,l),s(t,n)},p(e,t){128&t&&l!==(l=e[28]+"")&&w(n,l)},d(e){e&&u(t)}}}function Qe(e){let t,n,l=e[7].title.sort.filter(e[19]).map(e[20]).join(" / ")+"";return{c(){t=f("div"),n=d(l),b(t,"class","work--title-translations")},m(e,l){i(e,t,l),s(t,n)},p(e,t){128&t&&l!==(l=e[7].title.sort.filter(e[19]).map(e[20]).join(" / ")+"")&&w(n,l)},d(e){e&&u(t)}}}function ze(e){let t,n,l,r,o,c=e[7].description+"",a=e[7].note&&Ge(e);return{c(){t=f("div"),n=d(c),l=p(),a&&a.c(),b(t,"class","work--description")},m(c,u){i(c,t,u),s(t,n),s(t,l),a&&a.m(t,null),r||(o=g(t,"click",e[14]),r=!0)},p(e,l){128&l&&c!==(c=e[7].description+"")&&w(n,c),e[7].note?a?a.p(e,l):(a=Ge(e),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&u(t),a&&a.d(),r=!1,o()}}}function Ge(e){let t,n,l=e[7].note+"";return{c(){t=f("div"),n=d(l),b(t,"class","work--note")},m(e,l){i(e,t,l),s(t,n)},p(e,t){128&t&&l!==(l=e[7].note+"")&&w(n,l)},d(e){e&&u(t)}}}function We(e){let t,n,l,r,o=e[7].version+"";return{c(){t=f("div"),n=d(o),b(t,"class","work--version")},m(o,c){i(o,t,c),s(t,n),l||(r=g(t,"click",e[14]),l=!0)},p(e,t){128&t&&o!==(o=e[7].version+"")&&w(n,o)},d(e){e&&u(t),l=!1,r()}}}function Ye(e){let t,n;return t=new Ee({props:{work:e[7],fields:e[1],i18n:e[2],publishers:e[4]}}),{c(){P(t.$$.fragment)},m(e,l){Q(t,e,l),n=!0},p(e,n){const l={};128&n&&(l.work=e[7]),2&n&&(l.fields=e[1]),4&n&&(l.i18n=e[2]),16&n&&(l.publishers=e[4]),t.$set(l)},i(e){n||(N(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){z(t,e)}}}function Ze(e){let t,n,l=e[7].versions,r=[];for(let t=0;t<l.length;t+=1)r[t]=Je(Se(e,l,t));const o=e=>T(r[e],1,1,(()=>{r[e]=null}));return{c(){t=f("ul");for(let e=0;e<r.length;e+=1)r[e].c();b(t,"class","works--list")},m(e,l){i(e,t,l);for(let e=0;e<r.length;e+=1)r[e].m(t,null);n=!0},p(e,n){if(151&n){let c;for(l=e[7].versions,c=0;c<l.length;c+=1){const o=Se(e,l,c);r[c]?(r[c].p(o,n),N(r[c],1)):(r[c]=Je(o),r[c].c(),N(r[c],1),r[c].m(t,null))}for(B(),c=l.length;c<r.length;c+=1)o(c);H()}},i(e){if(!n){for(let e=0;e<l.length;e+=1)N(r[e]);n=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)T(r[e]);n=!1},d(e){e&&u(t),a(r,e)}}}function Je(e){let t,n;return t=new ot({props:{work:e[25],isSub:!0,categories:e[0],fields:e[1],i18n:e[2],publishers:e[4]}}),{c(){P(t.$$.fragment)},m(e,l){Q(t,e,l),n=!0},p(e,n){const l={};128&n&&(l.work=e[25]),1&n&&(l.categories=e[0]),2&n&&(l.fields=e[1]),4&n&&(l.i18n=e[2]),16&n&&(l.publishers=e[4]),t.$set(l)},i(e){n||(N(t.$$.fragment,e),n=!0)},o(e){T(t.$$.fragment,e),n=!1},d(e){z(t,e)}}}function Ke(e){let t,n,l=e[7].story&&Xe(e),r=e[7].audios&&et(e);return{c(){t=f("div"),l&&l.c(),n=p(),r&&r.c(),b(t,"class","work--multimedia")},m(e,o){i(e,t,o),l&&l.m(t,null),s(t,n),r&&r.m(t,null)},p(e,o){e[7].story?l?l.p(e,o):(l=Xe(e),l.c(),l.m(t,n)):l&&(l.d(1),l=null),e[7].audios?r?r.p(e,o):(r=et(e),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(e){e&&u(t),l&&l.d(),r&&r.d()}}}function Xe(e){let t,n,l;return{c(){t=f("a"),n=d("About the work"),b(t,"class","work--story"),b(t,"href",l=e[7].story)},m(e,l){i(e,t,l),s(t,n)},p(e,n){128&n&&l!==(l=e[7].story)&&b(t,"href",l)},d(e){e&&u(t)}}}function et(e){let t,n=e[7].audios,l=[];for(let t=0;t<n.length;t+=1)l[t]=tt(qe(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=h()},m(e,n){for(let t=0;t<l.length;t+=1)l[t].m(e,n);i(e,t,n)},p(e,r){if(128&r){let o;for(n=e[7].audios,o=0;o<n.length;o+=1){const c=qe(e,n,o);l[o]?l[o].p(c,r):(l[o]=tt(c),l[o].c(),l[o].m(t.parentNode,t))}for(;o<l.length;o+=1)l[o].d(1);l.length=n.length}},d(e){a(l,e),e&&u(t)}}}function tt(e){let t,n,l,r,o,c,a,h,k,$,v,y=e[22].description+"";function x(...t){return e[21](e[22],...t)}return{c(){t=f("button"),n=f("div"),l=p(),r=f("div"),o=f("h5"),c=d(y),a=p(),b(n,"class","play--button"),b(r,"class","play--meta"),b(t,"class","play small"),b(t,"data-audio",h=e[22].id),b(t,"data-title",k=e[22].description)},m(e,u){i(e,t,u),s(t,n),s(t,l),s(t,r),s(r,o),s(o,c),s(t,a),$||(v=g(t,"click",m(x)),$=!0)},p(n,l){e=n,128&l&&y!==(y=e[22].description+"")&&w(c,y),128&l&&h!==(h=e[22].id)&&b(t,"data-audio",h),128&l&&k!==(k=e[22].description)&&b(t,"data-title",k)},d(e){e&&u(t),$=!1,v()}}}function nt(e){let t;return{c(){t=f("div"),t.textContent="Reworks",b(t,"class","work--rework-label")},m(e,n){i(e,t,n)},d(e){e&&u(t)}}}function lt(e){let t,n,l,r,o,c,a,d,h,g,m,w,k,v,y,x=e[10]&&Ae(e),j=e[6]&&e[7].id&&Me(e),O=e[7].category&&Re(e),C=e[7].rework&&Be(e),_=e[7].title&&Te(e),F=e[7].description&&ze(e),L=e[7].version&&!e[7].isDefaultVersion&&We(e),I=e[1].length&&Ye(e),D=e[7].versions&&Ze(e),E=(e[7].story||e[7].audios)&&Ke(e),q=e[10]&&nt();return{c(){t=f("li"),x&&x.c(),n=p(),l=f("div"),j&&j.c(),r=p(),O&&O.c(),o=p(),C&&C.c(),c=p(),_&&_.c(),a=p(),F&&F.c(),d=p(),L&&L.c(),h=p(),I&&I.c(),g=p(),D&&D.c(),m=p(),E&&E.c(),k=p(),q&&q.c(),b(l,"class",w="work--"+(e[3]?"sub":"container")),$(l,"open",e[9]),$(l,"black",e[10]),$(l,"selected",e[12]),b(t,"class","work"),b(t,"id",v=e[7].id)},m(e,u){i(e,t,u),x&&x.m(t,null),s(t,n),s(t,l),j&&j.m(l,null),s(l,r),O&&O.m(l,null),s(l,o),C&&C.m(l,null),s(l,c),_&&_.m(l,null),s(l,a),F&&F.m(l,null),s(l,d),L&&L.m(l,null),s(l,h),I&&I.m(l,null),s(l,g),D&&D.m(l,null),s(l,m),E&&E.m(l,null),s(t,k),q&&q.m(t,null),y=!0},p(e,[s]){e[10]?x?x.p(e,s):(x=Ae(e),x.c(),x.m(t,n)):x&&(x.d(1),x=null),e[6]&&e[7].id?j?j.p(e,s):(j=Me(e),j.c(),j.m(l,r)):j&&(j.d(1),j=null),e[7].category?O?O.p(e,s):(O=Re(e),O.c(),O.m(l,o)):O&&(O.d(1),O=null),e[7].rework?C?C.p(e,s):(C=Be(e),C.c(),C.m(l,c)):C&&(C.d(1),C=null),e[7].title?_?_.p(e,s):(_=Te(e),_.c(),_.m(l,a)):_&&(_.d(1),_=null),e[7].description?F?F.p(e,s):(F=ze(e),F.c(),F.m(l,d)):F&&(F.d(1),F=null),e[7].version&&!e[7].isDefaultVersion?L?L.p(e,s):(L=We(e),L.c(),L.m(l,h)):L&&(L.d(1),L=null),e[1].length?I?(I.p(e,s),2&s&&N(I,1)):(I=Ye(e),I.c(),N(I,1),I.m(l,g)):I&&(B(),T(I,1,1,(()=>{I=null})),H()),e[7].versions?D?(D.p(e,s),128&s&&N(D,1)):(D=Ze(e),D.c(),N(D,1),D.m(l,m)):D&&(B(),T(D,1,1,(()=>{D=null})),H()),e[7].story||e[7].audios?E?E.p(e,s):(E=Ke(e),E.c(),E.m(l,null)):E&&(E.d(1),E=null),(!y||8&s&&w!==(w="work--"+(e[3]?"sub":"container")))&&b(l,"class",w),520&s&&$(l,"open",e[9]),1032&s&&$(l,"black",e[10]),4104&s&&$(l,"selected",e[12]),e[10]?q||(q=nt(),q.c(),q.m(t,null)):q&&(q.d(1),q=null),(!y||128&s&&v!==(v=e[7].id))&&b(t,"id",v)},i(e){y||(N(I),N(D),y=!0)},o(e){T(I),T(D),y=!1},d(e){e&&u(t),x&&x.d(),j&&j.d(),O&&O.d(),C&&C.d(),_&&_.d(),F&&F.d(),L&&L.d(),I&&I.d(),D&&D.d(),E&&E.d(),q&&q.d()}}}function rt(e,t,n){let l,r,o,c,{categories:s={}}=t,{fields:i=[]}=t,{i18n:u={}}=t,{isSub:a=!1}=t,{publishers:f={}}=t,{reworkActive:d=!1}=t,{showID:p=!1}=t,{work:h={}}=t;const g=j();let m=!1,b=!1;return e.$$set=e=>{"categories"in e&&n(0,s=e.categories),"fields"in e&&n(1,i=e.fields),"i18n"in e&&n(2,u=e.i18n),"isSub"in e&&n(3,a=e.isSub),"publishers"in e&&n(4,f=e.publishers),"reworkActive"in e&&n(5,d=e.reworkActive),"showID"in e&&n(6,p=e.showID),"work"in e&&n(7,h=e.work)},e.$$.update=()=>{128&e.$$.dirty&&n(8,l=h.rework!==h.id),288&e.$$.dirty&&n(10,r=d&&!l),128&e.$$.dirty&&n(11,o=h.title?.translations[h.title?.main]),65568&e.$$.dirty&&n(12,c=b&&d)},[s,i,u,a,f,d,p,h,l,m,r,o,c,g,function(){n(9,m=!m)},function(){n(16,b=!d),g("showReworks",h.rework||h.id)},b,e=>navigator.clipboard.writeText(e.target.textContent),()=>g("selectCategory",h.category),e=>e!==h.title.main,e=>h.title.translations[e],(e,t)=>{window.dispatchEvent(new window.CustomEvent("play",{detail:{target:t.target,audio:e.id}}))}]}class ot extends Y{constructor(e){super(),W(this,e,rt,lt,c,{categories:0,fields:1,i18n:2,isSub:3,publishers:4,reworkActive:5,showID:6,work:7})}}function ct(e,t,n){const l=e.slice();return l[9]=t[n].value,l[10]=t[n].facet,l[11]=t,l[12]=n,l}function st(e){let t,n,l,o,c,a,h,m,k,$,v,y,x,j=e[10].label+"",O=e[10].count+"";function C(){e[6].call(l,e[11],e[12])}function _(){return e[7](e[9])}return{c(){t=f("li"),n=f("label"),l=f("input"),c=p(),a=f("span"),h=d(j),m=p(),k=f("span"),$=d(O),v=p(),b(l,"type","checkbox"),b(l,"name",o=X(e[0],e[9])),b(a,"class","facet--name"),b(k,"class","facet--count")},m(r,o){i(r,t,o),s(t,n),s(n,l),l.checked=e[10].active,s(n,c),s(n,a),s(a,h),s(n,m),s(n,k),s(k,$),s(t,v),y||(x=[g(l,"change",C),g(l,"click",_)],y=!0)},p(t,n){e=t,17&n&&o!==(o=X(e[0],e[9]))&&b(l,"name",o),16&n&&(l.checked=e[10].active),16&n&&j!==(j=e[10].label+"")&&w(h,j),16&n&&O!==(O=e[10].count+"")&&w($,O)},d(e){e&&u(t),y=!1,r(x)}}}function it(e){let t,n,l;function r(e,t){return e[3]?at:ut}let o=r(e),c=o(e);return{c(){t=f("button"),c.c(),b(t,"class","link facet--more")},m(r,o){i(r,t,o),c.m(t,null),n||(l=g(t,"click",m(e[8])),n=!0)},p(e,n){o===(o=r(e))&&c?c.p(e,n):(c.d(1),c=o(e),c&&(c.c(),c.m(t,null)))},d(e){e&&u(t),c.d(),n=!1,l()}}}function ut(e){let t,n,l,r,o,c=e[1].toLowerCase()+"",s=Object.keys(e[2]).length-dt+"";return{c(){t=d("Show more "),n=d(c),l=d(" ("),r=d(s),o=d(")")},m(e,c){i(e,t,c),i(e,n,c),i(e,l,c),i(e,r,c),i(e,o,c)},p(e,t){2&t&&c!==(c=e[1].toLowerCase()+"")&&w(n,c),4&t&&s!==(s=Object.keys(e[2]).length-dt+"")&&w(r,s)},d(e){e&&u(t),e&&u(n),e&&u(l),e&&u(r),e&&u(o)}}}function at(e){let t,n,l,r,o=e[1].toLowerCase()+"";return{c(){t=d("Show first "),n=d(dt),l=p(),r=d(o)},m(e,o){i(e,t,o),i(e,n,o),i(e,l,o),i(e,r,o)},p(e,t){2&t&&o!==(o=e[1].toLowerCase()+"")&&w(r,o)},d(e){e&&u(t),e&&u(n),e&&u(l),e&&u(r)}}}function ft(t){let n,l,r,o=Object.keys(t[2]).length>dt,c=t[4],s=[];for(let e=0;e<c.length;e+=1)s[e]=st(ct(t,c,e));let d=o&&it(t);return{c(){n=f("ul");for(let e=0;e<s.length;e+=1)s[e].c();l=p(),d&&d.c(),r=h()},m(e,t){i(e,n,t);for(let e=0;e<s.length;e+=1)s[e].m(n,null);i(e,l,t),d&&d.m(e,t),i(e,r,t)},p(e,[t]){if(49&t){let l;for(c=e[4],l=0;l<c.length;l+=1){const r=ct(e,c,l);s[l]?s[l].p(r,t):(s[l]=st(r),s[l].c(),s[l].m(n,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=c.length}4&t&&(o=Object.keys(e[2]).length>dt),o?d?d.p(e,t):(d=it(e),d.c(),d.m(r.parentNode,r)):d&&(d.d(1),d=null)},i:e,o:e,d(e){e&&u(n),a(s,e),e&&u(l),d&&d.d(e),e&&u(r)}}}const dt=5;function pt(e,t,n){let l,{group:r=""}=t,{label:o=""}=t,{facets:c={}}=t;const s=j();let i=!1;return e.$$set=e=>{"group"in e&&n(0,r=e.group),"label"in e&&n(1,o=e.label),"facets"in e&&n(2,c=e.facets)},e.$$.update=()=>{12&e.$$.dirty&&n(4,l=function(e){return Object.entries(e).sort(((e,t)=>t[1].count>e[1].count?1:-1)).map((([e,t])=>({value:e,facet:t})))}(c).slice(0,i?c.length:dt))},[r,o,c,i,l,s,function(e,t){e[t].facet.active=this.checked,n(4,l),n(2,c),n(3,i)},e=>s("refine",X(r,e)),()=>{n(3,i=!i)}]}class ht extends Y{constructor(e){super(),W(this,e,pt,ft,c,{group:0,label:1,facets:2})}}function gt(e,t,n){const l=e.slice();return l[7]=t[n].group,l[8]=t[n].def,l}function mt(e){let n,l,r,o,c,a,h,g,m=e[8].label+"";const k=[{group:e[7]},e[8]];let $={};for(let e=0;e<k.length;e+=1)$=t($,k[e]);return c=new ht({props:$}),c.$on("refine",e[6]),{c(){n=f("div"),l=f("h4"),r=d(m),o=p(),P(c.$$.fragment),a=p(),b(n,"class",h="facets "+e[7])},m(e,t){i(e,n,t),s(n,l),s(l,r),s(n,o),Q(c,n,null),s(n,a),g=!0},p(e,t){(!g||1&t)&&m!==(m=e[8].label+"")&&w(r,m);const l=1&t?function(e,t){const n={},l={},r={$$scope:1};let o=e.length;for(;o--;){const c=e[o],s=t[o];if(s){for(const e in c)e in s||(l[e]=1);for(const e in s)r[e]||(n[e]=s[e],r[e]=1);e[o]=s}else for(const e in c)r[e]=1}for(const e in l)e in n||(n[e]=void 0);return n}(k,[{group:e[7]},(o=e[8],"object"==typeof o&&null!==o?o:{})]):{};var o;c.$set(l),(!g||1&t&&h!==(h="facets "+e[7]))&&b(n,"class",h)},i(e){g||(N(c.$$.fragment,e),g=!0)},o(e){T(c.$$.fragment,e),g=!1},d(e){e&&u(n),z(c)}}}function bt(e){let t,n,l,r,o,c,d,h,w,k,$=e[0],v=[];for(let t=0;t<$.length;t+=1)v[t]=mt(gt(e,$,t));const y=e=>T(v[e],1,1,(()=>{v[e]=null}));return{c(){t=f("div"),n=f("button"),n.innerHTML='<svg viewBox="0 0 24 24" width="24" height="24"><path d="M6,13H18V11H6M3,6V8H21V6M10,18H14V16H10V18Z"></path></svg> \n    <span class="refine--handler-label">Refine results</span>',l=p(),r=f("div"),o=f("h3"),o.textContent="Refine results",c=p(),d=f("div");for(let e=0;e<v.length;e+=1)v[e].c();b(n,"class","refine--handler"),b(d,"class","facets"),b(r,"class","refine--inner"),b(t,"class","refine--wrapper")},m(e,u){i(e,t,u),s(t,n),s(t,l),s(t,r),s(r,o),s(r,c),s(r,d);for(let e=0;e<v.length;e+=1)v[e].m(d,null);h=!0,w||(k=g(n,"click",m(wt)),w=!0)},p(e,[t]){if(1&t){let n;for($=e[0],n=0;n<$.length;n+=1){const l=gt(e,$,n);v[n]?(v[n].p(l,t),N(v[n],1)):(v[n]=mt(l),v[n].c(),N(v[n],1),v[n].m(d,null))}for(B(),n=$.length;n<v.length;n+=1)y(n);H()}},i(e){if(!h){for(let e=0;e<$.length;e+=1)N(v[e]);h=!0}},o(e){v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)T(v[e]);h=!1},d(e){e&&u(t),a(v,e),w=!1,k()}}}function wt(e){document.querySelector(".refine").classList.toggle("open")}function kt(e,t,n){let l,{activeFacets:r=[]}=t,{categories:o={}}=t,{genres:c={}}=t,{publishers:s={}}=t,{works:i=[]}=t;return window.addEventListener("scroll",(()=>{const e=document.querySelector(".refine"),t=document.querySelector(".refine--wrapper");if(!e)return;const n=e.getBoundingClientRect(),l=e.parentElement,r=e.querySelector(".refine--inner"),o=l.getBoundingClientRect(),c=n.height-r.scrollHeight,s=o.bottom>window.innerHeight+c;n.y<=0&&s?t.classList.add("sticked"):t.classList.remove("sticked")})),e.$$set=e=>{"activeFacets"in e&&n(1,r=e.activeFacets),"categories"in e&&n(2,o=e.categories),"genres"in e&&n(3,c=e.genres),"publishers"in e&&n(4,s=e.publishers),"works"in e&&n(5,i=e.works)},e.$$.update=()=>{62&e.$$.dirty&&n(0,l=function({activeFacets:e=[],categories:t={},genres:n={},publishers:l={},works:r=[]}){const o=r.reduce(((e,t)=>{for(const n of t.facets)e[n]||(e[n]=0),e[n]+=1;return e}),{});return Object.entries(o).reduce(((r,[o,c])=>{const{group:s,value:i}=function(e){const t=e.split(".");return{group:t[0],value:t[1]}}(o);let u=r.findIndex((e=>e.group===s));return-1===u&&(r.push({group:s,def:{label:K[s].label,facets:{}}}),u=r.length-1),r[u].def.facets[i]={count:c,value:i,active:e.includes(o),label:K[s].getLabel({value:i,categories:t,genres:n,publishers:l})},r.sort(((e,t)=>K[e.group].order>K[t.group].order?1:-1))}),[])}({activeFacets:r,categories:o,genres:c,publishers:s,works:i}))},[l,r,o,c,s,i,function(t){O(e,t)}]}class $t extends Y{constructor(e){super(),W(this,e,kt,bt,c,{activeFacets:1,categories:2,genres:3,publishers:4,works:5})}}function vt(t){let n;return{c(){n=f("ul"),b(n,"class","works-pagination")},m(e,t){i(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}class yt extends Y{constructor(e){super(),W(this,e,null,vt,c,{})}}function xt(e,t,n){const l=e.slice();return l[15]=t[n],l}function jt(t){let n,l,r,o,c,a,h,g=t[18].message+"",m=(console.error(t[18])&&"")+"";return{c(){n=f("p"),l=d("Failed to initialize catalogue: "),r=f("strong"),o=d(g),c=d("."),a=p(),h=d(m)},m(e,t){i(e,n,t),s(n,l),s(n,r),s(r,o),s(n,c),i(e,a,t),i(e,h,t)},p:e,i:e,o:e,d(e){e&&u(n),e&&u(a),e&&u(h)}}}function Ot(e){let t,n,l,r,o,c,a,h,g,m,k,$,v,y,x,j,O=e[1].length+"",C=[],_=new Map;l=new ce({props:{value:e[0].query}}),l.$on("updateQuery",e[10]);let F=e[2];const L=e=>e[15].id;for(let t=0;t<F.length;t+=1){let n=xt(e,F,t),l=L(n);_.set(l,C[t]=Ct(l,n))}return v=new $t({props:{activeFacets:e[0].activeFacets,categories:e[14].catalogue.categories,genres:e[14].catalogue.genres,publishers:e[14].catalogue.publishers,works:e[1]}}),v.$on("refine",e[5]),x=new yt({}),{c(){t=f("div"),n=f("div"),P(l.$$.fragment),r=p(),o=f("div"),c=f("span"),a=d(O),h=d("\n\t\t\t\t\t\tworks"),g=p(),m=f("ul");for(let e=0;e<C.length;e+=1)C[e].c();k=p(),$=f("div"),P(v.$$.fragment),y=p(),P(x.$$.fragment),b(c,"class","works--count-amount"),b(o,"class","works--count"),b(m,"class","works--list"),b(n,"class","column list"),b($,"class","column refine"),b(t,"class","row")},m(e,u){i(e,t,u),s(t,n),Q(l,n,null),s(n,r),s(n,o),s(o,c),s(c,a),s(o,h),s(n,g),s(n,m);for(let e=0;e<C.length;e+=1)C[e].m(m,null);s(t,k),s(t,$),Q(v,$,null),i(e,y,u),Q(x,e,u),j=!0},p(e,t){const n={};1&t&&(n.value=e[0].query),l.$set(n),(!j||2&t)&&O!==(O=e[1].length+"")&&w(a,O),29&t&&(F=e[2],B(),C=function(e,t,n,l,r,o,c,s,i,u,a,f){let d=e.length,p=o.length,h=d;const g={};for(;h--;)g[e[h].key]=h;const m=[],b=new Map,w=new Map;for(h=p;h--;){const e=f(r,o,h),s=n(e);let i=c.get(s);i?l&&i.p(e,t):(i=u(s,e),i.c()),b.set(s,m[h]=i),s in g&&w.set(s,Math.abs(h-g[s]))}const k=new Set,$=new Set;function v(e){N(e,1),e.m(s,a),c.set(e.key,e),a=e.first,p--}for(;d&&p;){const t=m[p-1],n=e[d-1],l=t.key,r=n.key;t===n?(a=t.first,d--,p--):b.has(r)?!c.has(l)||k.has(l)?v(t):$.has(r)?d--:w.get(l)>w.get(r)?($.add(l),v(t)):(k.add(r),d--):(i(n,c),d--)}for(;d--;){const t=e[d];b.has(t.key)||i(t,c)}for(;p;)v(m[p-1]);return m}(C,t,L,1,e,F,_,m,U,Ct,null,xt),H());const r={};1&t&&(r.activeFacets=e[0].activeFacets),2&t&&(r.works=e[1]),v.$set(r)},i(e){if(!j){N(l.$$.fragment,e);for(let e=0;e<F.length;e+=1)N(C[e]);N(v.$$.fragment,e),N(x.$$.fragment,e),j=!0}},o(e){T(l.$$.fragment,e);for(let e=0;e<C.length;e+=1)T(C[e]);T(v.$$.fragment,e),T(x.$$.fragment,e),j=!1},d(e){e&&u(t),z(l);for(let e=0;e<C.length;e+=1)C[e].d();z(v),e&&u(y),z(x,e)}}}function Ct(e,t){let n,l,r;return l=new ot({props:{categories:t[14].catalogue.categories,fields:t[14].catalogue.fields,i18n:t[14].i18n,publishers:t[14].catalogue.publishers,reworkActive:Boolean(t[0].reworksOf),showID:t[0].showID,work:t[15]}}),l.$on("selectCategory",t[4]),l.$on("showReworks",t[11]),{key:e,first:null,c(){n=h(),P(l.$$.fragment),this.first=n},m(e,t){i(e,n,t),Q(l,e,t),r=!0},p(e,n){t=e;const r={};1&n&&(r.reworkActive=Boolean(t[0].reworksOf)),1&n&&(r.showID=t[0].showID),4&n&&(r.work=t[15]),l.$set(r)},i(e){r||(N(l.$$.fragment,e),r=!0)},o(e){T(l.$$.fragment,e),r=!1},d(e){e&&u(n),z(l,e)}}}function _t(t){let n;return{c(){n=f("p"),n.textContent="Loading catalogue data..."},m(e,t){i(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function Ft(e){let t,n,l,r,o,c={ctx:e,current:null,token:null,hasCatch:!0,pending:_t,then:Ot,catch:jt,value:14,error:18,blocks:[,,,]};return function(e,t){const n=t.token={};function l(e,l,r,o){if(t.token!==n)return;t.resolved=o;let c=t.ctx;void 0!==r&&(c=c.slice(),c[r]=o);const s=e&&(t.current=e)(c);let i=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==l&&e&&(B(),T(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),H())})):t.block.d(1),s.c(),N(s,1),s.m(t.mount(),t.anchor),i=!0),t.block=s,t.blocks&&(t.blocks[l]=s),i&&V()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=x();if(e.then((e=>{y(n),l(t.then,1,t.value,e),y(null)}),(e=>{if(y(n),l(t.catch,2,t.error,e),y(null),!t.hasCatch)throw e})),t.current!==t.pending)return l(t.pending,0),!0}else{if(t.current!==t.then)return l(t.then,1,t.value,e),!0;t.resolved=e}var r}(e[3](),c),{c(){t=f("form"),n=f("div"),c.block.c(),b(n,"class","works"),b(t,"class","catalogue search")},m(u,a){i(u,t,a),s(t,n),c.block.m(n,c.anchor=null),c.mount=()=>n,c.anchor=null,l=!0,r||(o=g(t,"submit",m(e[9])),r=!0)},p(t,[n]){{const l=(e=t).slice();l[14]=l[18]=c.resolved,c.block.p(l,n)}},i(e){l||(N(c.block),l=!0)},o(e){for(let e=0;e<3;e+=1){T(c.blocks[e])}l=!1},d(e){e&&u(t),c.block.d(),c.token=null,c=null,r=!1,o()}}}function Lt(e,t,n){let l,r,o,c=!1,s={},i=[];function u({activeFacets:e,index:t,query:n,reworksOf:l,sort:r,works:o}){let c=o;return l?c=o.filter((e=>e.rework===l)).sort(((e,t)=>e.id===l?-1:1)):(c=function({index:e,query:t,works:n}){if(t.startsWith("id:"))return n.filter((e=>e.id===t.split(":")[1]));{if(!e.search)return n;const l=e.search(t).map((e=>e.ref));return n.filter((e=>l.includes(e.id)))}}({works:o,index:t,query:n}),c=function({activeFacets:e,works:t}){return e.length?t.filter((t=>e.every((e=>t.facets.includes(e))))):t}({activeFacets:e,works:c})),window.scrollTo(0,400),c}function a(e){const t=e.detail;n(0,o.activeFacets=o.activeFacets.includes(t)?o.activeFacets.filter((e=>e!==t)):[...o.activeFacets,t],o)}var f;f=()=>{!function(e){let t=e;for(;"section"!==t.tagName.toLowerCase();)t=t.parentNode;t&&(t.style.overflow="hidden")}(document.getElementById("catalogue-app")),n(6,c=!0)},x().$$.on_mount.push(f);return e.$$.update=()=>{65&e.$$.dirty&&(c?te(o):n(0,o=ne())),385&e.$$.dirty&&n(1,l=u({...o,index:s,works:i})),2&e.$$.dirty&&n(2,r=l)},[o,l,r,async function(){const e={};return await Promise.all(Object.entries(Z).map((([t,n])=>fetch(n).then((e=>e.json())).then((n=>{e[t]=n}))))),n(8,i=function(e=[]){return e.map((e=>({...e,facets:Object.entries(K).reduce(((t,[n,l])=>{const r=l.getValues(e);return r.length&&(t=[...t,...X(n,r)]),t}),[])})))}(e.catalogue.works)),n(7,s=lunr.Index.load(e.index)),e},function(e){a({detail:X("c",e.detail)})},a,c,s,i,function(t){O(e,t)},e=>n(0,o.query=e.detail,o),e=>n(0,o.reworksOf=o.reworksOf===e.detail?"":e.detail,o)]}class It extends Y{constructor(e){super(),W(this,e,Lt,Ft,c,{})}}const Dt=document.getElementById("catalogue-app");let Et={};return Dt&&(Et=new It({target:Dt})),Et}();
//# sourceMappingURL=bundle.js.map
